{"modules":{"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/common/index.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/common/index.js","source":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/** Creates a dropdown box.\n * @param btn The button to open and close the dropdown box.\n * @param box The node containing the contents of the dropdown box.\n */\n\nvar addDropdownBox = exports.addDropdownBox = function addDropdownBox(btn, box) {\n    btn.bind('mousedown', function (event) {\n        event.preventDefault();\n        if (btn.hasClass('disabled')) {\n            return;\n        }\n        if ('none' == box.css('display')) {\n            openDropdownBox(box);\n        }\n    });\n};\n\n/** Opens a dropdown box.\n * @param box The node containing the contents of the dropdown box.\n */\n\nvar openDropdownBox = function openDropdownBox(box) {\n    // Show this box\n    box.show();\n    // Give that the dropdown menu was opened through a mousedown event, there\n    // will be a first click event following it. We will wait for the second\n    // click event.\n    jQuery(document).one('click', function () {\n        jQuery(document).one('click', function (event) {\n            event.preventDefault();\n            box.hide();\n        });\n    });\n};\n\n/** Checkes or uncheckes a checkable label. This is used for example for bibliography categories when editing bibliography items.\n * @param label The node who's parent has to be checked or unchecked.\n */\nvar setCheckableLabel = exports.setCheckableLabel = function setCheckableLabel(label) {\n    var checkbox = label.parent().find('input[type=checkbox]');\n    if (label.hasClass('checked')) {\n        label.removeClass('checked');\n    } else {\n        label.addClass('checked');\n    }\n};\n\n/** Cover the page signaling to the user to wait.\n */\nvar activateWait = exports.activateWait = function activateWait() {\n    jQuery('#wait').addClass('active');\n};\n\n/** Remove the wait cover.\n */\nvar deactivateWait = exports.deactivateWait = function deactivateWait() {\n    jQuery('#wait').removeClass('active');\n};\n\n/** Show a message to the user.\n * @param alertType The type of message that is shown (error, warning, info or success).\n * @param alertMsg The message text.\n */\nvar addAlert = exports.addAlert = function addAlert(alertType, alertMsg) {\n    var fadeSpeed = 300;\n    var iconNames = {\n        'error': 'icon-attention-circle',\n        'warning': 'icon-attention-circle',\n        'info': 'icon-info-circle',\n        'success': 'icon-ok'\n    };\n    var alertBox = jQuery('<li class=\"alerts-' + alertType + ' ' + iconNames[alertType] + '\">' + alertMsg + '</li>');\n    if (0 === jQuery('#alerts-outer-wrapper').length) jQuery('body').append('<div id=\"alerts-outer-wrapper\"><ul id=\"alerts-wrapper\"></ul></div>');\n    jQuery('#alerts-wrapper').append(alertBox);\n    alertBox.fadeTo(fadeSpeed, 1, function () {\n        jQuery(this).delay('2000').fadeOut(fadeSpeed, function () {\n            jQuery(this).remove();\n        });\n    });\n};\n\n/** Turn milliseconds since epoch (UTC) into a local date string.\n * @param {number} milliseconds Number of milliseconds since epoch (1/1/1970 midnight, UTC).\n * @param {boolean} sortable Whether the result should appear in a date only list.\n */\nvar localizeDate = exports.localizeDate = function localizeDate(milliseconds, sortable) {\n    milliseconds = parseInt(milliseconds);\n    if (milliseconds > 0) {\n        var theDate = new Date(milliseconds);\n        if (true === sortable) {\n            var yyyy = theDate.getFullYear(),\n                mm = theDate.getMonth() + 1,\n                dd = theDate.getDate();\n\n            if (10 > mm) {\n                mm = '0' + mm;\n            }\n\n            return yyyy + '/' + mm + '/' + dd;\n        } else {\n            return theDate.toLocaleString();\n        }\n    } else {\n        return '';\n    }\n};\n\n/** Get cookie to set as part of the request header of all AJAX requests to the server.\n * @param name The name of the token to look for in the cookie.\n */\nvar getCookie = exports.getCookie = function getCookie(name) {\n    var cookieValue = null;\n    if (document.cookie && document.cookie !== '') {\n        var cookies = document.cookie.split(';');\n        for (var i = 0; i < cookies.length; i++) {\n            var cookie = jQuery.trim(cookies[i]);\n            // Does this cookie string begin with the name we want?\n            if (cookie.substring(0, name.length + 1) == name + '=') {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n};\n\n/**\n * The Cross Site Request Forgery (CSRF) token\n */\nvar csrfToken = exports.csrfToken = getCookie('csrftoken');\n\n/**\n * Turn string literals into single line, removing spaces at start of line\n */\n\nvar noSpaceTmp = exports.noSpaceTmp = function noSpaceTmp(strings) {\n    var values = [].slice.call(arguments);\n    var tmpStrings = [].slice.call(values.shift());\n\n    var combined = \"\";\n    while (tmpStrings.length > 0 || values.length > 0) {\n        if (tmpStrings.length > 0) {\n            combined += tmpStrings.shift();\n        }\n        if (values.length > 0) {\n            combined += values.shift();\n        }\n    }\n\n    var out = \"\";\n    combined.split('\\n').forEach(function (line) {\n        out += line.replace(/^\\s*/g, '');\n    });\n    return out;\n};\n\n/**\n * Return a cancel promise if you need to cancel a promise chain. Import as\n * ES6 promises are not (yet) cancelable.\n */\n\nvar cancelPromise = exports.cancelPromise = function cancelPromise() {\n    return new Promise(function () {});\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImFkZERyb3Bkb3duQm94IiwiYnRuIiwiYm94IiwiYmluZCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJoYXNDbGFzcyIsImNzcyIsIm9wZW5Ecm9wZG93bkJveCIsInNob3ciLCJqUXVlcnkiLCJkb2N1bWVudCIsIm9uZSIsImhpZGUiLCJzZXRDaGVja2FibGVMYWJlbCIsImxhYmVsIiwiY2hlY2tib3giLCJwYXJlbnQiLCJmaW5kIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImFjdGl2YXRlV2FpdCIsImRlYWN0aXZhdGVXYWl0IiwiYWRkQWxlcnQiLCJhbGVydFR5cGUiLCJhbGVydE1zZyIsImZhZGVTcGVlZCIsImljb25OYW1lcyIsImFsZXJ0Qm94IiwibGVuZ3RoIiwiYXBwZW5kIiwiZmFkZVRvIiwiZGVsYXkiLCJmYWRlT3V0IiwicmVtb3ZlIiwibG9jYWxpemVEYXRlIiwibWlsbGlzZWNvbmRzIiwic29ydGFibGUiLCJwYXJzZUludCIsInRoZURhdGUiLCJEYXRlIiwieXl5eSIsImdldEZ1bGxZZWFyIiwibW0iLCJnZXRNb250aCIsImRkIiwiZ2V0RGF0ZSIsInRvTG9jYWxlU3RyaW5nIiwiZ2V0Q29va2llIiwibmFtZSIsImNvb2tpZVZhbHVlIiwiY29va2llIiwiY29va2llcyIsInNwbGl0IiwiaSIsInRyaW0iLCJzdWJzdHJpbmciLCJkZWNvZGVVUklDb21wb25lbnQiLCJjc3JmVG9rZW4iLCJub1NwYWNlVG1wIiwic3RyaW5ncyIsInZhbHVlcyIsInNsaWNlIiwiY2FsbCIsImFyZ3VtZW50cyIsInRtcFN0cmluZ3MiLCJzaGlmdCIsImNvbWJpbmVkIiwib3V0IiwiZm9yRWFjaCIsImxpbmUiLCJyZXBsYWNlIiwiY2FuY2VsUHJvbWlzZSIsIlByb21pc2UiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsQUFLQTs7Ozs7QUFBTyxJQUFJLDBDQUFpQix3QkFBQSxBQUFTLEtBQVQsQUFBYyxLQUFLLEFBQzND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V0FBWixBQUFZLEFBQVcsQUFDMUI7QUFDRDtZQUFJLE9BQUEsQUFBTyxTQUFYLEFBQW9CLEdBQUcsQUFDbkI7d0JBQVksT0FBWixBQUFZLEFBQU8sQUFDdEI7QUFDSjtBQUVEOztRQUFJLE1BQUosQUFBVSxBQUNWO2FBQUEsQUFBUyxNQUFULEFBQWUsTUFBZixBQUFxQixRQUFRLGdCQUFRLEFBQ2pDO2VBQU8sS0FBQSxBQUFLLFFBQUwsQUFBYSxTQUFwQixBQUFPLEFBQXFCLEFBQy9CO0FBRkQsQUFHQTtXQUFBLEFBQU8sQUFDVjtBQW5CTTs7QUFxQlIsQUFLQzs7Ozs7QUFBTyxJQUFJO0FBQWdCLFdBQU0sSUFBQSxBQUFJLFFBQVEsWUFBSSxBQUFFLENBQTVDLEFBQTBCIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIENyZWF0ZXMgYSBkcm9wZG93biBib3guXG4gKiBAcGFyYW0gYnRuIFRoZSBidXR0b24gdG8gb3BlbiBhbmQgY2xvc2UgdGhlIGRyb3Bkb3duIGJveC5cbiAqIEBwYXJhbSBib3ggVGhlIG5vZGUgY29udGFpbmluZyB0aGUgY29udGVudHMgb2YgdGhlIGRyb3Bkb3duIGJveC5cbiAqL1xuXG5leHBvcnQgbGV0IGFkZERyb3Bkb3duQm94ID0gZnVuY3Rpb24oYnRuLCBib3gpIHtcbiAgICBidG4uYmluZCgnbW91c2Vkb3duJywgZXZlbnQgPT4ge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIGlmKGJ0bi5oYXNDbGFzcygnZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgaWYoJ25vbmUnID09IGJveC5jc3MoJ2Rpc3BsYXknKSkge1xuICAgICAgICAgICAgb3BlbkRyb3Bkb3duQm94KGJveClcbiAgICAgICAgfVxuICAgIH0pXG59XG5cbi8qKiBPcGVucyBhIGRyb3Bkb3duIGJveC5cbiAqIEBwYXJhbSBib3ggVGhlIG5vZGUgY29udGFpbmluZyB0aGUgY29udGVudHMgb2YgdGhlIGRyb3Bkb3duIGJveC5cbiAqL1xuXG5sZXQgb3BlbkRyb3Bkb3duQm94ID0gZnVuY3Rpb24oYm94KSB7XG4gICAgLy8gU2hvdyB0aGlzIGJveFxuICAgIGJveC5zaG93KClcbiAgICAvLyBHaXZlIHRoYXQgdGhlIGRyb3Bkb3duIG1lbnUgd2FzIG9wZW5lZCB0aHJvdWdoIGEgbW91c2Vkb3duIGV2ZW50LCB0aGVyZVxuICAgIC8vIHdpbGwgYmUgYSBmaXJzdCBjbGljayBldmVudCBmb2xsb3dpbmcgaXQuIFdlIHdpbGwgd2FpdCBmb3IgdGhlIHNlY29uZFxuICAgIC8vIGNsaWNrIGV2ZW50LlxuICAgIGpRdWVyeShkb2N1bWVudCkub25lKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgalF1ZXJ5KGRvY3VtZW50KS5vbmUoJ2NsaWNrJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgYm94LmhpZGUoKVxuICAgICAgICB9KVxuICAgIH0pXG59XG5cblxuLyoqIENoZWNrZXMgb3IgdW5jaGVja2VzIGEgY2hlY2thYmxlIGxhYmVsLiBUaGlzIGlzIHVzZWQgZm9yIGV4YW1wbGUgZm9yIGJpYmxpb2dyYXBoeSBjYXRlZ29yaWVzIHdoZW4gZWRpdGluZyBiaWJsaW9ncmFwaHkgaXRlbXMuXG4gKiBAcGFyYW0gbGFiZWwgVGhlIG5vZGUgd2hvJ3MgcGFyZW50IGhhcyB0byBiZSBjaGVja2VkIG9yIHVuY2hlY2tlZC5cbiAqL1xuZXhwb3J0IGxldCBzZXRDaGVja2FibGVMYWJlbCA9IGZ1bmN0aW9uKGxhYmVsKSB7XG4gICAgbGV0IGNoZWNrYm94ID0gbGFiZWwucGFyZW50KCkuZmluZCgnaW5wdXRbdHlwZT1jaGVja2JveF0nKVxuICAgIGlmKGxhYmVsLmhhc0NsYXNzKCdjaGVja2VkJykpIHtcbiAgICAgICAgbGFiZWwucmVtb3ZlQ2xhc3MoJ2NoZWNrZWQnKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGxhYmVsLmFkZENsYXNzKCdjaGVja2VkJylcbiAgICB9XG59XG5cbi8qKiBDb3ZlciB0aGUgcGFnZSBzaWduYWxpbmcgdG8gdGhlIHVzZXIgdG8gd2FpdC5cbiAqL1xuZXhwb3J0IGxldCBhY3RpdmF0ZVdhaXQgPSBmdW5jdGlvbigpIHtcbiAgICBqUXVlcnkoJyN3YWl0JykuYWRkQ2xhc3MoJ2FjdGl2ZScpXG59XG5cbi8qKiBSZW1vdmUgdGhlIHdhaXQgY292ZXIuXG4gKi9cbmV4cG9ydCBsZXQgZGVhY3RpdmF0ZVdhaXQgPSBmdW5jdGlvbigpIHtcbiAgICBqUXVlcnkoJyN3YWl0JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpXG59XG5cbi8qKiBTaG93IGEgbWVzc2FnZSB0byB0aGUgdXNlci5cbiAqIEBwYXJhbSBhbGVydFR5cGUgVGhlIHR5cGUgb2YgbWVzc2FnZSB0aGF0IGlzIHNob3duIChlcnJvciwgd2FybmluZywgaW5mbyBvciBzdWNjZXNzKS5cbiAqIEBwYXJhbSBhbGVydE1zZyBUaGUgbWVzc2FnZSB0ZXh0LlxuICovXG5leHBvcnQgbGV0IGFkZEFsZXJ0ID0gZnVuY3Rpb24oYWxlcnRUeXBlLCBhbGVydE1zZykge1xuICAgIGxldCBmYWRlU3BlZWQgPSAzMDBcbiAgICBsZXQgaWNvbk5hbWVzID0ge1xuICAgICAgICAnZXJyb3InOiAnaWNvbi1hdHRlbnRpb24tY2lyY2xlJyxcbiAgICAgICAgJ3dhcm5pbmcnOiAnaWNvbi1hdHRlbnRpb24tY2lyY2xlJyxcbiAgICAgICAgJ2luZm8nOiAnaWNvbi1pbmZvLWNpcmNsZScsXG4gICAgICAgICdzdWNjZXNzJzogJ2ljb24tb2snXG4gICAgfVxuICAgIGxldCBhbGVydEJveCA9IGpRdWVyeSgnPGxpIGNsYXNzPVwiYWxlcnRzLScgKyBhbGVydFR5cGUgKyAnICcgKyBpY29uTmFtZXNbYWxlcnRUeXBlXSArICdcIj4nICsgYWxlcnRNc2cgKyAnPC9saT4nKVxuICAgIGlmKDAgPT09IGpRdWVyeSgnI2FsZXJ0cy1vdXRlci13cmFwcGVyJykubGVuZ3RoKVxuICAgICAgICBqUXVlcnkoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJhbGVydHMtb3V0ZXItd3JhcHBlclwiPjx1bCBpZD1cImFsZXJ0cy13cmFwcGVyXCI+PC91bD48L2Rpdj4nKVxuICAgIGpRdWVyeSgnI2FsZXJ0cy13cmFwcGVyJykuYXBwZW5kKGFsZXJ0Qm94KVxuICAgIGFsZXJ0Qm94LmZhZGVUbyhmYWRlU3BlZWQsIDEsIGZ1bmN0aW9uKCkge1xuICAgICAgICBqUXVlcnkodGhpcykuZGVsYXkoJzIwMDAnKS5mYWRlT3V0KGZhZGVTcGVlZCwgZnVuY3Rpb24oKSB7IGpRdWVyeSh0aGlzKS5yZW1vdmUoKSB9KVxuICAgIH0pXG59XG5cblxuLyoqIFR1cm4gbWlsbGlzZWNvbmRzIHNpbmNlIGVwb2NoIChVVEMpIGludG8gYSBsb2NhbCBkYXRlIHN0cmluZy5cbiAqIEBwYXJhbSB7bnVtYmVyfSBtaWxsaXNlY29uZHMgTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSBlcG9jaCAoMS8xLzE5NzAgbWlkbmlnaHQsIFVUQykuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHNvcnRhYmxlIFdoZXRoZXIgdGhlIHJlc3VsdCBzaG91bGQgYXBwZWFyIGluIGEgZGF0ZSBvbmx5IGxpc3QuXG4gKi9cbmV4cG9ydCBsZXQgbG9jYWxpemVEYXRlID0gZnVuY3Rpb24gKG1pbGxpc2Vjb25kcywgc29ydGFibGUpIHtcbiAgICBtaWxsaXNlY29uZHMgPSBwYXJzZUludChtaWxsaXNlY29uZHMpXG4gICAgaWYgKG1pbGxpc2Vjb25kcyA+IDApIHtcbiAgICAgICAgbGV0IHRoZURhdGUgPSBuZXcgRGF0ZShtaWxsaXNlY29uZHMpXG4gICAgICAgIGlmICh0cnVlID09PSBzb3J0YWJsZSkge1xuICAgICAgICAgICAgbGV0IHl5eXkgPSB0aGVEYXRlLmdldEZ1bGxZZWFyKCksXG4gICAgICAgICAgICAgICAgbW0gPSB0aGVEYXRlLmdldE1vbnRoKCkgKyAxLFxuICAgICAgICAgICAgICAgIGRkID0gdGhlRGF0ZS5nZXREYXRlKClcblxuICAgICAgICAgICAgaWYgKDEwID4gbW0pIHtcbiAgICAgICAgICAgICAgICBtbSA9ICcwJyArIG1tXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB5eXl5ICsgJy8nICsgbW0gKyAnLycgKyBkZFxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoZURhdGUudG9Mb2NhbGVTdHJpbmcoKVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gJydcbiAgICB9XG59XG5cbi8qKiBHZXQgY29va2llIHRvIHNldCBhcyBwYXJ0IG9mIHRoZSByZXF1ZXN0IGhlYWRlciBvZiBhbGwgQUpBWCByZXF1ZXN0cyB0byB0aGUgc2VydmVyLlxuICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgb2YgdGhlIHRva2VuIHRvIGxvb2sgZm9yIGluIHRoZSBjb29raWUuXG4gKi9cbmV4cG9ydCBsZXQgZ2V0Q29va2llID0gZnVuY3Rpb24obmFtZSkge1xuICAgIGxldCBjb29raWVWYWx1ZSA9IG51bGxcbiAgICBpZiAoZG9jdW1lbnQuY29va2llICYmIGRvY3VtZW50LmNvb2tpZSAhPT0gJycpIHtcbiAgICAgICAgbGV0IGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvb2tpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBjb29raWUgPSBqUXVlcnkudHJpbShjb29raWVzW2ldKVxuICAgICAgICAgICAgLy8gRG9lcyB0aGlzIGNvb2tpZSBzdHJpbmcgYmVnaW4gd2l0aCB0aGUgbmFtZSB3ZSB3YW50P1xuICAgICAgICAgICAgaWYgKGNvb2tpZS5zdWJzdHJpbmcoMCwgbmFtZS5sZW5ndGggKyAxKSA9PSAobmFtZSArICc9JykpIHtcbiAgICAgICAgICAgICAgICBjb29raWVWYWx1ZSA9IGRlY29kZVVSSUNvbXBvbmVudChjb29raWUuc3Vic3RyaW5nKG5hbWUubGVuZ3RoICsgMSkpXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29va2llVmFsdWVcbn1cblxuLyoqXG4gKiBUaGUgQ3Jvc3MgU2l0ZSBSZXF1ZXN0IEZvcmdlcnkgKENTUkYpIHRva2VuXG4gKi9cbmV4cG9ydCBsZXQgY3NyZlRva2VuID0gZ2V0Q29va2llKCdjc3JmdG9rZW4nKVxuXG5cbi8qKlxuICogVHVybiBzdHJpbmcgbGl0ZXJhbHMgaW50byBzaW5nbGUgbGluZSwgcmVtb3Zpbmcgc3BhY2VzIGF0IHN0YXJ0IG9mIGxpbmVcbiAqL1xuXG4gZXhwb3J0IGxldCBub1NwYWNlVG1wID0gZnVuY3Rpb24oc3RyaW5ncykge1xuICAgICBsZXQgdmFsdWVzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMpXG4gICAgIGxldCB0bXBTdHJpbmdzID0gW10uc2xpY2UuY2FsbCh2YWx1ZXMuc2hpZnQoKSlcblxuICAgICBsZXQgY29tYmluZWQgPSBcIlwiXG4gICAgIHdoaWxlICh0bXBTdHJpbmdzLmxlbmd0aCA+IDAgfHwgdmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgIGlmICh0bXBTdHJpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICBjb21iaW5lZCArPSB0bXBTdHJpbmdzLnNoaWZ0KClcbiAgICAgICAgIH1cbiAgICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgIGNvbWJpbmVkICs9IHZhbHVlcy5zaGlmdCgpXG4gICAgICAgICB9XG4gICAgIH1cblxuICAgICBsZXQgb3V0ID0gXCJcIlxuICAgICBjb21iaW5lZC5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgIG91dCArPSBsaW5lLnJlcGxhY2UoL15cXHMqL2csJycpXG4gICAgIH0pXG4gICAgIHJldHVybiBvdXRcbiB9XG5cbi8qKlxuICogUmV0dXJuIGEgY2FuY2VsIHByb21pc2UgaWYgeW91IG5lZWQgdG8gY2FuY2VsIGEgcHJvbWlzZSBjaGFpbi4gSW1wb3J0IGFzXG4gKiBFUzYgcHJvbWlzZXMgYXJlIG5vdCAoeWV0KSBjYW5jZWxhYmxlLlxuICovXG5cbiBleHBvcnQgbGV0IGNhbmNlbFByb21pc2UgPSAoKSA9PiBuZXcgUHJvbWlzZSgoKT0+e30pXG4iXX0=","deps":{}},"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/templates.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/templates.js","source":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/** A template to edit image categories. */\nvar usermediaEditcategoriesTemplate = exports.usermediaEditcategoriesTemplate = _.template('\\\n    <div id=\"editCategories\" title=\"<%- dialogHeader %>\">\\\n        <table id=\"editCategoryList\" class=\"fw-dialog-table\"><tbody><%= categories %></tbody></table>\\\n    </div>');\n\n/** A template for the image category edit form. */\nvar usermediaCategoryformsTemplate = exports.usermediaCategoryformsTemplate = _.template('\\\n    <% _.each(categories, function(cat) { %>\\\n    <tr id=\"categoryTr_<%- cat.id %>\" class=\"fw-list-input\">\\\n        <td>\\\n            <input type=\"text\" class=\"category-form\" id=\"categoryTitle_<%- cat.id %>\" value=\"<%= cat.category_title %>\" data-id=\"<%- cat.id %>\" />\\\n            <span class=\"fw-add-input icon-addremove\"></span>\\\n        </td>\\\n    </tr>\\\n    <% }) %>\\\n    <tr class=\"fw-list-input\">\\\n        <td>\\\n            <input type=\"text\" class=\"category-form\" />\\\n            <span class=\"fw-add-input icon-addremove\"></span>\\\n        </td>\\\n    </tr>');\n\n/** A template for image overview list. */\nvar usermediaTableTemplate = exports.usermediaTableTemplate = _.template('\\\n                <tr id=\"Image_<%- pk %>\" class=\"<% _.each(cats, function(cat) { %>cat_<%- cat %> <% }) %>\">\\\n                    <td width=\"30\">\\\n                        <span class=\"fw-inline\">\\\n                            <input type=\"checkbox\" class=\"entry-select\" data-id=\"<%- pk %>\">\\\n                        </span>\\\n                    </td>\\\n                    <td width=\"350\" class=\"title\">\\\n                        <span class=\"fw-usermedia-image\">\\\n                            <img src=\"<% if(thumbnail) { %><%- thumbnail %><% } else { %><%- image %><% } %>\">\\\n                        </span>\\\n                        <span class=\"fw-inline fw-usermedia-title\">\\\n                            <span class=\"edit-image fw-link-text fw-searchable\" data-id=\"<%- pk %>\">\\\n                                <%- title !== \"\" ? title : \"' + gettext('Untitled') + '\" %>\\\n                            </span>\\\n                            <span class=\"fw-usermedia-type\"><%- fileType %></span>\\\n                        </span>\\\n                    </td>\\\n                    <td width=\"170\" class=\"type \">\\\n                        <span class=\"fw-inline\"><%- width %> x <%- height %></span>\\\n                    </td>\\\n                    <td width=\"170\" class=\"file_type \">\\\n                        <span class=\"fw-inline\"><%= localizeDate(added, true) %></span>\\\n                    </td>\\\n                    <td width=\"50\" align=\"center\">\\\n                        <span class=\"delete-image fw-inline fw-link-text\" data-id=\"<%- pk %>\" data-title=\"<%- title %>\">\\\n                            <i class=\"icon-trash\"></i>\\\n                        </span>\\\n                    </td>\\\n                </tr>');\n\n/* A template for each image category list item */\nvar usermediaCategoryListItemTemplate = exports.usermediaCategoryListItemTemplate = _.template('\\\n    <li>\\\n        <span class=\"fw-pulldown-item\" data-id=\"<%- iCat.id %>\">\\\n            <%- iCat.category_title %>\\\n        </span>\\\n    </li>');\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlbXBsYXRlcy5qcyJdLCJuYW1lcyI6WyJ1c2VybWVkaWFFZGl0Y2F0ZWdvcmllc1RlbXBsYXRlIiwiXyIsInRlbXBsYXRlIiwidXNlcm1lZGlhQ2F0ZWdvcnlmb3Jtc1RlbXBsYXRlIiwidXNlcm1lZGlhVGFibGVUZW1wbGF0ZSIsImdldHRleHQiLCJ1c2VybWVkaWFDYXRlZ29yeUxpc3RJdGVtVGVtcGxhdGUiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsQUFDQTtBQUFPLElBQUksOEVBQWtDLEFBQUUsU0FBeEMsQUFBc0MsQUFBVzs7O1dBQVg7O0FBSzdDLEFBQ0E7QUFBTyxJQUFJLDRFQUFpQyxBQUFFLFNBQXZDLEFBQXFDLEFBQVc7Ozs7Ozs7Ozs7Ozs7O1VBQVg7O0FBZ0I1QyxBQUNBO0FBQU8sSUFBSSw0REFBeUIsQUFBRTs7Ozs7Ozs7Ozs7Ozs2REFBUyxHQWFlLFFBYmYsQUFhZSxBQUFRLGNBYi9ELEFBQTZCLEFBYThDOzs7Ozs7Ozs7Ozs7Ozs7O3NCQWI5Qzs7QUErQnBDLEFBQ0E7QUFBTyxJQUFJLGtGQUFvQyxBQUFFLFNBQTFDLEFBQXdDLEFBQVc7Ozs7O1VBQVgiLCJmaWxlIjoidGVtcGxhdGVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIEEgdGVtcGxhdGUgdG8gZWRpdCBpbWFnZSBjYXRlZ29yaWVzLiAqL1xuZXhwb3J0IGxldCB1c2VybWVkaWFFZGl0Y2F0ZWdvcmllc1RlbXBsYXRlID0gXy50ZW1wbGF0ZSgnXFxcbiAgICA8ZGl2IGlkPVwiZWRpdENhdGVnb3JpZXNcIiB0aXRsZT1cIjwlLSBkaWFsb2dIZWFkZXIgJT5cIj5cXFxuICAgICAgICA8dGFibGUgaWQ9XCJlZGl0Q2F0ZWdvcnlMaXN0XCIgY2xhc3M9XCJmdy1kaWFsb2ctdGFibGVcIj48dGJvZHk+PCU9IGNhdGVnb3JpZXMgJT48L3Rib2R5PjwvdGFibGU+XFxcbiAgICA8L2Rpdj4nKVxuXG4vKiogQSB0ZW1wbGF0ZSBmb3IgdGhlIGltYWdlIGNhdGVnb3J5IGVkaXQgZm9ybS4gKi9cbmV4cG9ydCBsZXQgdXNlcm1lZGlhQ2F0ZWdvcnlmb3Jtc1RlbXBsYXRlID0gXy50ZW1wbGF0ZSgnXFxcbiAgICA8JSBfLmVhY2goY2F0ZWdvcmllcywgZnVuY3Rpb24oY2F0KSB7ICU+XFxcbiAgICA8dHIgaWQ9XCJjYXRlZ29yeVRyXzwlLSBjYXQuaWQgJT5cIiBjbGFzcz1cImZ3LWxpc3QtaW5wdXRcIj5cXFxuICAgICAgICA8dGQ+XFxcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiY2F0ZWdvcnktZm9ybVwiIGlkPVwiY2F0ZWdvcnlUaXRsZV88JS0gY2F0LmlkICU+XCIgdmFsdWU9XCI8JT0gY2F0LmNhdGVnb3J5X3RpdGxlICU+XCIgZGF0YS1pZD1cIjwlLSBjYXQuaWQgJT5cIiAvPlxcXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZ3LWFkZC1pbnB1dCBpY29uLWFkZHJlbW92ZVwiPjwvc3Bhbj5cXFxuICAgICAgICA8L3RkPlxcXG4gICAgPC90cj5cXFxuICAgIDwlIH0pICU+XFxcbiAgICA8dHIgY2xhc3M9XCJmdy1saXN0LWlucHV0XCI+XFxcbiAgICAgICAgPHRkPlxcXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImNhdGVnb3J5LWZvcm1cIiAvPlxcXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZ3LWFkZC1pbnB1dCBpY29uLWFkZHJlbW92ZVwiPjwvc3Bhbj5cXFxuICAgICAgICA8L3RkPlxcXG4gICAgPC90cj4nKVxuXG4vKiogQSB0ZW1wbGF0ZSBmb3IgaW1hZ2Ugb3ZlcnZpZXcgbGlzdC4gKi9cbmV4cG9ydCBsZXQgdXNlcm1lZGlhVGFibGVUZW1wbGF0ZSA9IF8udGVtcGxhdGUoJ1xcXG4gICAgICAgICAgICAgICAgPHRyIGlkPVwiSW1hZ2VfPCUtIHBrICU+XCIgY2xhc3M9XCI8JSBfLmVhY2goY2F0cywgZnVuY3Rpb24oY2F0KSB7ICU+Y2F0XzwlLSBjYXQgJT4gPCUgfSkgJT5cIj5cXFxuICAgICAgICAgICAgICAgICAgICA8dGQgd2lkdGg9XCIzMFwiPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZ3LWlubGluZVwiPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwiZW50cnktc2VsZWN0XCIgZGF0YS1pZD1cIjwlLSBwayAlPlwiPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XFxcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cXFxuICAgICAgICAgICAgICAgICAgICA8dGQgd2lkdGg9XCIzNTBcIiBjbGFzcz1cInRpdGxlXCI+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZnctdXNlcm1lZGlhLWltYWdlXCI+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz1cIjwlIGlmKHRodW1ibmFpbCkgeyAlPjwlLSB0aHVtYm5haWwgJT48JSB9IGVsc2UgeyAlPjwlLSBpbWFnZSAlPjwlIH0gJT5cIj5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZ3LWlubGluZSBmdy11c2VybWVkaWEtdGl0bGVcIj5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZWRpdC1pbWFnZSBmdy1saW5rLXRleHQgZnctc2VhcmNoYWJsZVwiIGRhdGEtaWQ9XCI8JS0gcGsgJT5cIj5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8JS0gdGl0bGUgIT09IFwiXCIgPyB0aXRsZSA6IFwiJytnZXR0ZXh0KCdVbnRpdGxlZCcpKydcIiAlPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmdy11c2VybWVkaWEtdHlwZVwiPjwlLSBmaWxlVHlwZSAlPjwvc3Bhbj5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxcXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XFxcbiAgICAgICAgICAgICAgICAgICAgPHRkIHdpZHRoPVwiMTcwXCIgY2xhc3M9XCJ0eXBlIFwiPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZ3LWlubGluZVwiPjwlLSB3aWR0aCAlPiB4IDwlLSBoZWlnaHQgJT48L3NwYW4+XFxcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cXFxuICAgICAgICAgICAgICAgICAgICA8dGQgd2lkdGg9XCIxNzBcIiBjbGFzcz1cImZpbGVfdHlwZSBcIj5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmdy1pbmxpbmVcIj48JT0gbG9jYWxpemVEYXRlKGFkZGVkLCB0cnVlKSAlPjwvc3Bhbj5cXFxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxcXG4gICAgICAgICAgICAgICAgICAgIDx0ZCB3aWR0aD1cIjUwXCIgYWxpZ249XCJjZW50ZXJcIj5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJkZWxldGUtaW1hZ2UgZnctaW5saW5lIGZ3LWxpbmstdGV4dFwiIGRhdGEtaWQ9XCI8JS0gcGsgJT5cIiBkYXRhLXRpdGxlPVwiPCUtIHRpdGxlICU+XCI+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImljb24tdHJhc2hcIj48L2k+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cXFxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxcXG4gICAgICAgICAgICAgICAgPC90cj4nKVxuXG4vKiBBIHRlbXBsYXRlIGZvciBlYWNoIGltYWdlIGNhdGVnb3J5IGxpc3QgaXRlbSAqL1xuZXhwb3J0IGxldCB1c2VybWVkaWFDYXRlZ29yeUxpc3RJdGVtVGVtcGxhdGUgPSBfLnRlbXBsYXRlKCdcXFxuICAgIDxsaT5cXFxuICAgICAgICA8c3BhbiBjbGFzcz1cImZ3LXB1bGxkb3duLWl0ZW1cIiBkYXRhLWlkPVwiPCUtIGlDYXQuaWQgJT5cIj5cXFxuICAgICAgICAgICAgPCUtIGlDYXQuY2F0ZWdvcnlfdGl0bGUgJT5cXFxuICAgICAgICA8L3NwYW4+XFxcbiAgICA8L2xpPicpXG4iXX0=","deps":{}},"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/database.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/database.js","source":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ImageDB = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _common = require('../common');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/* A class that holds information about images uploaded by the user. */\n\nvar ImageDB = exports.ImageDB = function () {\n    function ImageDB(userId) {\n        _classCallCheck(this, ImageDB);\n\n        this.userId = userId;\n        this.db = {};\n        this.cats = [];\n    }\n\n    _createClass(ImageDB, [{\n        key: 'getDB',\n        value: function getDB() {\n            var _this = this;\n\n            this.db = {};\n            this.cats = [];\n\n            (0, _common.activateWait)();\n            return new Promise(function (resolve, reject) {\n                jQuery.ajax({\n                    url: '/usermedia/images/',\n                    data: {\n                        'owner_id': _this.userId\n                    },\n                    type: 'POST',\n                    dataType: 'json',\n                    crossDomain: false, // obviates need for sameOrigin test\n                    beforeSend: function beforeSend(xhr, settings) {\n                        return xhr.setRequestHeader(\"X-CSRFToken\", _common.csrfToken);\n                    },\n                    success: function success(response, textStatus, jqXHR) {\n                        _this.cats = response.imageCategories;\n                        var pks = [];\n                        for (var i = 0; i < response.images.length; i++) {\n                            response.images[i].image = response.images[i].image.split('?')[0];\n                            _this.db[response.images[i]['pk']] = response.images[i];\n                            pks.push(response.images[i]['pk']);\n                        }\n                        resolve(pks);\n                    },\n                    error: function error(jqXHR, textStatus, errorThrown) {\n                        (0, _common.addAlert)('error', jqXHR.responseText);\n                        reject();\n                    },\n                    complete: function complete() {\n                        return (0, _common.deactivateWait)();\n                    }\n                });\n            });\n        }\n    }, {\n        key: 'createImage',\n        value: function createImage(postData) {\n            var _this2 = this;\n\n            (0, _common.activateWait)();\n            // Remove old warning messages\n            jQuery('#uploadimage .warning').detach();\n\n            return new Promise(function (resolve, reject) {\n                // Send to server\n                jQuery.ajax({\n                    url: '/usermedia/save/',\n                    data: postData,\n                    type: 'POST',\n                    dataType: 'json',\n                    crossDomain: false, // obviates need for sameOrigin test\n                    beforeSend: function beforeSend(xhr, settings) {\n                        return xhr.setRequestHeader(\"X-CSRFToken\", _common.csrfToken);\n                    },\n                    success: function success(response, textStatus, jqXHR) {\n                        if (_this2.displayCreateImageError(response.errormsg)) {\n                            _this2.db[response.values.pk] = response.values;\n                            (0, _common.addAlert)('success', gettext('The image has been uploaded'));\n                            resolve(response.values.pk);\n                        } else {\n                            (0, _common.addAlert)('error', gettext('Some errors are found. Please examine the form.'));\n                            reject();\n                        }\n                    },\n                    error: function error(jqXHR, textStatus, errorThrown) {\n                        if (jqXHR && jqXHR.responseJSON && jqXHR.responseJSON.errormsg) {\n                            (0, _common.addAlert)('error', jqXHR.responseJSON.errormsg);\n                        }\n                        reject();\n                    },\n                    complete: function complete() {\n                        return (0, _common.deactivateWait)();\n                    },\n                    cache: false,\n                    contentType: false,\n                    processData: false\n                });\n            });\n        }\n    }, {\n        key: 'displayCreateImageError',\n        value: function displayCreateImageError(errors) {\n            var noError = true;\n            for (var eKey in errors) {\n                var eMsg = '<div class=\"warning\">' + errors[eKey] + '</div>';\n                if ('error' == eKey) {\n                    jQuery('#uploadimage').prepend(eMsg);\n                } else {\n                    jQuery('#id_' + eKey).after(eMsg);\n                }\n                noError = false;\n            }\n            return noError;\n        }\n    }]);\n\n    return ImageDB;\n}();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhdGFiYXNlLmpzIl0sIm5hbWVzIjpbImFjdGl2YXRlV2FpdCIsImRlYWN0aXZhdGVXYWl0IiwiYWRkQWxlcnQiLCJjc3JmVG9rZW4iLCJJbWFnZURCIiwiY29uc3RydWN0b3IiLCJ1c2VySWQiLCJkYiIsImNhdHMiLCJnZXREQiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwialF1ZXJ5IiwiYWpheCIsInVybCIsImRhdGEiLCJ0eXBlIiwiZGF0YVR5cGUiLCJjcm9zc0RvbWFpbiIsImJlZm9yZVNlbmQiLCJ4aHIiLCJzZXR0aW5ncyIsInNldFJlcXVlc3RIZWFkZXIiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJ0ZXh0U3RhdHVzIiwianFYSFIiLCJpbWFnZUNhdGVnb3JpZXMiLCJwa3MiLCJpIiwiaW1hZ2VzIiwibGVuZ3RoIiwiaW1hZ2UiLCJzcGxpdCIsInB1c2giLCJlcnJvciIsImVycm9yVGhyb3duIiwicmVzcG9uc2VUZXh0IiwiY29tcGxldGUiLCJjcmVhdGVJbWFnZSIsInBvc3REYXRhIiwiZGV0YWNoIiwiZGlzcGxheUNyZWF0ZUltYWdlRXJyb3IiLCJlcnJvcm1zZyIsInZhbHVlcyIsInBrIiwiZ2V0dGV4dCIsInJlc3BvbnNlSlNPTiIsImNhY2hlIiwiY29udGVudFR5cGUiLCJwcm9jZXNzRGF0YSIsImVycm9ycyIsIm5vRXJyb3IiLCJlS2V5IiwiZU1zZyIsInByZXBlbmQiLCJhZnRlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsQUFBUSxBQUFjLEFBQWdCLEFBQVUsQUFBZ0I7Ozs7QUFHaEUsQUFFQSxBQUFPOztJQUFBLEFBQU0sQUFBUSxBQUNqQjtxQkFBQSxBQUFZO0FBQVEsQUFDaEI7O2FBQUEsQUFBSyxTQUFMLEFBQWMsQUFDZDthQUFBLEFBQUssS0FBTCxBQUFVLEFBQ1Y7YUFBQSxBQUFLLE9BQUwsQUFBWSxBQUNmO0FBRUQ7Ozs7O0FBQVEsQUFDSjs7aUJBQUEsQUFBSyxLQUFMLEFBQVUsQUFDVjtpQkFBQSxBQUFL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QW5DVTtBQXFDWDs7O2dEQUFBLEFBQXdCLFFBQVEsQUFDNUI7Z0JBQUksVUFBSixBQUFjLEFBQ2Q7aUJBQUssSUFBTCxBQUFTLFFBQVQsQUFBaUIsUUFBUSxBQUNyQjtvQkFBSSxPQUFPLDBCQUEwQixPQUExQixBQUEwQixBQUFPLFFBQTVDLEFBQW9ELEFBQ3BEO29CQUFJLFdBQUosQUFBZSxNQUFNLEFBQ2pCOzJCQUFBLEFBQU8sZ0JBQVAsQUFBdUIsUUFBdkIsQUFBK0IsQUFDbEM7QUFGRCx1QkFFTyxBQUNIOzJCQUFPLFNBQVAsQUFBZ0IsTUFBaEIsQUFBc0IsTUFBdEIsQUFBNEIsQUFDL0I7QUFDRDswQkFBQSxBQUFVLEFBQ2I7QUFDRDttQkFBQSxBQUFPLEFBQ1Y7QUFoR2dCIiwiZmlsZSI6ImRhdGFiYXNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHthY3RpdmF0ZVdhaXQsIGRlYWN0aXZhdGVXYWl0LCBhZGRBbGVydCwgY3NyZlRva2VufSBmcm9tIFwiLi4vY29tbW9uXCJcblxuXG4vKiBBIGNsYXNzIHRoYXQgaG9sZHMgaW5mb3JtYXRpb24gYWJvdXQgaW1hZ2VzIHVwbG9hZGVkIGJ5IHRoZSB1c2VyLiAqL1xuXG5leHBvcnQgY2xhc3MgSW1hZ2VEQiB7XG4gICAgY29uc3RydWN0b3IodXNlcklkKSB7XG4gICAgICAgIHRoaXMudXNlcklkID0gdXNlcklkXG4gICAgICAgIHRoaXMuZGIgPSB7fVxuICAgICAgICB0aGlzLmNhdHMgPSBbXVxuICAgIH1cblxuICAgIGdldERCKCkge1xuICAgICAgICB0aGlzLmRiID0ge31cbiAgICAgICAgdGhpcy5jYXRzID0gW11cblxuICAgICAgICBhY3RpdmF0ZVdhaXQoKVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgalF1ZXJ5LmFqYXgoe1xuICAgICAgICAgICAgICAgIHVybDogJy91c2VybWVkaWEvaW1hZ2VzLycsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAnb3duZXJfaWQnOiB0aGlzLnVzZXJJZFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICAgICAgY3Jvc3NEb21haW46IGZhbHNlLCAvLyBvYnZpYXRlcyBuZWVkIGZvciBzYW1lT3JpZ2luIHRlc3RcbiAgICAgICAgICAgICAgICBiZWZvcmVTZW5kOiAoeGhyLCBzZXR0aW5ncykgPT5cbiAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJYLUNTUkZUb2tlblwiLCBjc3JmVG9rZW4pLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IChyZXNwb25zZSwgdGV4dFN0YXR1cywganFYSFIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXRzID0gcmVzcG9uc2UuaW1hZ2VDYXRlZ29yaWVzXG4gICAgICAgICAgICAgICAgICAgIGxldCBwa3MgPSBbXVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3BvbnNlLmltYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuaW1hZ2VzW2ldLmltYWdlID0gcmVzcG9uc2UuaW1hZ2VzW2ldLmltYWdlLnNwbGl0KCc/JylbMF1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGJbcmVzcG9uc2UuaW1hZ2VzW2ldWydwayddXSA9IHJlc3BvbnNlLmltYWdlc1tpXVxuICAgICAgICAgICAgICAgICAgICAgICAgcGtzLnB1c2gocmVzcG9uc2UuaW1hZ2VzW2ldWydwayddKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocGtzKVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IChqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYWRkQWxlcnQoJ2Vycm9yJywganFYSFIucmVzcG9uc2VUZXh0KVxuICAgICAgICAgICAgICAgICAgICByZWplY3QoKVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29tcGxldGU6ICgpID0+IGRlYWN0aXZhdGVXYWl0KClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgY3JlYXRlSW1hZ2UocG9zdERhdGEpIHtcbiAgICAgICAgYWN0aXZhdGVXYWl0KClcbiAgICAgICAgLy8gUmVtb3ZlIG9sZCB3YXJuaW5nIG1lc3NhZ2VzXG4gICAgICAgIGpRdWVyeSgnI3VwbG9hZGltYWdlIC53YXJuaW5nJykuZGV0YWNoKClcblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgLy8gU2VuZCB0byBzZXJ2ZXJcbiAgICAgICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvdXNlcm1lZGlhL3NhdmUvJyxcbiAgICAgICAgICAgICAgICBkYXRhOiBwb3N0RGF0YSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICBjcm9zc0RvbWFpbjogZmFsc2UsIC8vIG9idmlhdGVzIG5lZWQgZm9yIHNhbWVPcmlnaW4gdGVzdFxuICAgICAgICAgICAgICAgIGJlZm9yZVNlbmQ6ICh4aHIsIHNldHRpbmdzKSA9PlxuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtQ1NSRlRva2VuXCIsIGNzcmZUb2tlbiksXG4gICAgICAgICAgICAgICAgc3VjY2VzczogKHJlc3BvbnNlLCB0ZXh0U3RhdHVzLCBqcVhIUikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kaXNwbGF5Q3JlYXRlSW1hZ2VFcnJvcihyZXNwb25zZS5lcnJvcm1zZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGJbcmVzcG9uc2UudmFsdWVzLnBrXSA9IHJlc3BvbnNlLnZhbHVlc1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkQWxlcnQoJ3N1Y2Nlc3MnLCBnZXR0ZXh0KCdUaGUgaW1hZ2UgaGFzIGJlZW4gdXBsb2FkZWQnKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UudmFsdWVzLnBrKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkQWxlcnQoJ2Vycm9yJywgZ2V0dGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnU29tZSBlcnJvcnMgYXJlIGZvdW5kLiBQbGVhc2UgZXhhbWluZSB0aGUgZm9ybS4nXG4gICAgICAgICAgICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IChqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpxWEhSICYmIGpxWEhSLnJlc3BvbnNlSlNPTiAmJiBqcVhIUi5yZXNwb25zZUpTT04uZXJyb3Jtc2cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEFsZXJ0KCdlcnJvcicsIGpxWEhSLnJlc3BvbnNlSlNPTi5lcnJvcm1zZylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZWplY3QoKVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29tcGxldGU6ICgpID0+IGRlYWN0aXZhdGVXYWl0KCksXG4gICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2VcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG5cbiAgICB9XG5cbiAgICBkaXNwbGF5Q3JlYXRlSW1hZ2VFcnJvcihlcnJvcnMpIHtcbiAgICAgICAgbGV0IG5vRXJyb3IgPSB0cnVlXG4gICAgICAgIGZvciAobGV0IGVLZXkgaW4gZXJyb3JzKSB7XG4gICAgICAgICAgICBsZXQgZU1zZyA9ICc8ZGl2IGNsYXNzPVwid2FybmluZ1wiPicgKyBlcnJvcnNbZUtleV0gKyAnPC9kaXY+J1xuICAgICAgICAgICAgaWYgKCdlcnJvcicgPT0gZUtleSkge1xuICAgICAgICAgICAgICAgIGpRdWVyeSgnI3VwbG9hZGltYWdlJykucHJlcGVuZChlTXNnKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBqUXVlcnkoJyNpZF8nICsgZUtleSkuYWZ0ZXIoZU1zZylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub0Vycm9yXG4gICAgfVxuXG59XG4iXX0=","deps":{"../common":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/common/index.js"}},"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/menu/index.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/menu/index.js","source":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Menu = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _common = require('../common');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Bindings for the menu\n\nvar Menu = exports.Menu = function () {\n    function Menu(activeItem) {\n        _classCallCheck(this, Menu);\n\n        this.activeItem = activeItem;\n        this.bind();\n    }\n\n    _createClass(Menu, [{\n        key: 'bind',\n        value: function bind() {\n            var _this = this;\n\n            jQuery(document).ready(function () {\n                _this.markCurrentlyActive();\n                _this.bindPreferencePullDown();\n            });\n        }\n    }, {\n        key: 'markCurrentlyActive',\n        value: function markCurrentlyActive() {\n            // Mark currently active menu item\n            var active = jQuery('body > header a[data-item=\"' + this.activeItem + '\"]');\n            active.addClass('active');\n            active.parent().addClass('active-menu-wrapper');\n        }\n    }, {\n        key: 'bindPreferencePullDown',\n        value: function bindPreferencePullDown() {\n            var box = jQuery('#user-preferences-pulldown');\n            var button = jQuery('#preferences-btn');\n            (0, _common.addDropdownBox)(button, box);\n\n            // In addition to adding the dropdown, we also need to add some css\n            // values so that the dropdown is placed close to #preferences-btn\n            jQuery('#preferences-btn').bind('mousedown', function () {\n                var btnOffset = button.offset();\n                box.css({\n                    'left': btnOffset.left - 52,\n                    'top': btnOffset.top + 27\n                });\n            });\n            // As a click will close the pulldown, we need to activate the link by means of a mousedown already.\n            jQuery(document).on('mousedown', '#user-preferences-pulldown a', function (event) {\n                event.preventDefault();\n                window.location = jQuery(this).attr('href');\n            });\n            // Same for form button\n            jQuery(document).on('mousedown', '#user-preferences-pulldown button[type=\"submit\"]', function (event) {\n                event.preventDefault();\n                jQuery(this).closest('form').submit();\n            });\n        }\n    }]);\n\n    return Menu;\n}();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImFkZERyb3Bkb3duQm94IiwiTWVudSIsImNvbnN0cnVjdG9yIiwiYWN0aXZlSXRlbSIsImJpbmQiLCJqUXVlcnkiLCJkb2N1bWVudCIsInJlYWR5IiwibWFya0N1cnJlbnRseUFjdGl2ZSIsImJpbmRQcmVmZXJlbmNlUHVsbERvd24iLCJhY3RpdmUiLCJhZGRDbGFzcyIsInBhcmVudCIsImJveCIsImJ1dHRvbiIsImJ0bk9mZnNldCIsIm9mZnNldCIsImNzcyIsImxlZnQiLCJ0b3AiLCJvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImF0dHIiLCJjbG9zZXN0Iiwic3VibWl0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxBQUFRLEFBQXFCOzs7O0FBRTdCLEFBRUEsQUFBTzs7SUFBQSxBQUFNLEFBQUssQUFDZDtrQkFBQSxBQUFZO0FBQVksQUFDcEI7O2FBQUEsQUFBSyxhQUFMLEFBQWtCLEFBQ2xCO2FBQUEsQUFBSyxBQUNSO0FBRUQ7Ozs7O0FBQU8sQUFDSDs7bUJBQUEsQUFBTyxVQUFQLEFBQWlCLE1BQU0sWUFBTSxBQUN6QjtzQkFBQSxBQUFLLEFBQ0w7c0JBQUEsQUFBSyxBQUNSO0FBSEQsQUFJSDtBQUVEOzs7OENBQXNCLEFBQ2xCO0FBQ0E7Z0JBQUksU0FBUyxBQUFRLHVDQUE2QixLQUFsRCxBQUFhLEFBQTBDLEFBQVcsQUFDbEU7bUJBQUEsQUFBTyxTQUFQLEFBQWdCLEFBQ2hCO21CQUFBLEFBQU8sU0FBUCxBQUFnQixTQUFoQixBQUF5QixBQUM1QjtBQUVEOzs7aURBQXlCLEFBQ3JCO2dCQUFJLE1BQU0sT0FBVixBQUFVLEFBQU8sQUFDakI7Z0JBQUksU0FBUyxPQUFiLEFBQWEsQUFBTyxBQUNwQjt3Q0FBQSxBQUFlLFFBQWYsQUFBdUIsQUFFdkI7O0FBQ0E7QUFDQTttQkFBQSxBQUFPLG9CQUFQLEFBQTJCLEtBQTNCLEFBQWdDLGFBQWEsWUFBTSxBQUMvQztvQkFBSSxZQUFZLE9BQWhCLEFBQWdCLEFBQU8sQUFDdkI7b0JBQUEsQUFBSTs0QkFDUSxVQUFBLEFBQVUsT0FEZCxBQUNxQixBQUN6QjsyQkFBTyxVQUFBLEFBQVUsTUFGckIsQUFBUSxBQUVtQixBQUU5QjtBQUpXLEFBQ0o7QUFIUixBQU9BO0FBQ0E7bUJBQUEsQUFBTyxVQUFQLEFBQWlCLEdBQWpCLEFBQW9CLGFBQXBCLEFBQWlDLGdDQUFnQyxVQUFBLEFBQVMsT0FBTyxBQUM3RTtzQkFBQSxBQUFNLEFBQ047dUJBQUEsQUFBTyxXQUFXLE9BQUEsQUFBTyxNQUFQLEFBQWEsS0FBL0IsQUFBa0IsQUFBa0IsQUFDdkM7QUFIRCxBQUlBO0FBQ0E7bUJBQUEsQUFBTyxVQUFQLEFBQWlCLEdBQWpCLEFBQW9CLGFBQXBCLEFBQWlDLG9EQUFvRCxVQUFBLEFBQVMsT0FBTyxBQUNqRztzQkFBQSxBQUFNLEFBQ047dUJBQUEsQUFBTyxNQUFQLEFBQWEsUUFBYixBQUFxQixRQUFyQixBQUE2QixBQUNoQztBQUhELEFBSUg7QUE1Q2EiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2FkZERyb3Bkb3duQm94fSBmcm9tIFwiLi4vY29tbW9uXCJcblxuLy8gQmluZGluZ3MgZm9yIHRoZSBtZW51XG5cbmV4cG9ydCBjbGFzcyBNZW51IHtcbiAgICBjb25zdHJ1Y3RvcihhY3RpdmVJdGVtKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IGFjdGl2ZUl0ZW1cbiAgICAgICAgdGhpcy5iaW5kKClcbiAgICB9XG5cbiAgICBiaW5kKCkge1xuICAgICAgICBqUXVlcnkoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubWFya0N1cnJlbnRseUFjdGl2ZSgpXG4gICAgICAgICAgICB0aGlzLmJpbmRQcmVmZXJlbmNlUHVsbERvd24oKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIG1hcmtDdXJyZW50bHlBY3RpdmUoKSB7XG4gICAgICAgIC8vIE1hcmsgY3VycmVudGx5IGFjdGl2ZSBtZW51IGl0ZW1cbiAgICAgICAgbGV0IGFjdGl2ZSA9IGpRdWVyeShgYm9keSA+IGhlYWRlciBhW2RhdGEtaXRlbT1cIiR7dGhpcy5hY3RpdmVJdGVtfVwiXWApXG4gICAgICAgIGFjdGl2ZS5hZGRDbGFzcygnYWN0aXZlJylcbiAgICAgICAgYWN0aXZlLnBhcmVudCgpLmFkZENsYXNzKCdhY3RpdmUtbWVudS13cmFwcGVyJylcbiAgICB9XG5cbiAgICBiaW5kUHJlZmVyZW5jZVB1bGxEb3duKCkge1xuICAgICAgICBsZXQgYm94ID0galF1ZXJ5KCcjdXNlci1wcmVmZXJlbmNlcy1wdWxsZG93bicpXG4gICAgICAgIGxldCBidXR0b24gPSBqUXVlcnkoJyNwcmVmZXJlbmNlcy1idG4nKVxuICAgICAgICBhZGREcm9wZG93bkJveChidXR0b24sIGJveClcblxuICAgICAgICAvLyBJbiBhZGRpdGlvbiB0byBhZGRpbmcgdGhlIGRyb3Bkb3duLCB3ZSBhbHNvIG5lZWQgdG8gYWRkIHNvbWUgY3NzXG4gICAgICAgIC8vIHZhbHVlcyBzbyB0aGF0IHRoZSBkcm9wZG93biBpcyBwbGFjZWQgY2xvc2UgdG8gI3ByZWZlcmVuY2VzLWJ0blxuICAgICAgICBqUXVlcnkoJyNwcmVmZXJlbmNlcy1idG4nKS5iaW5kKCdtb3VzZWRvd24nLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgYnRuT2Zmc2V0ID0gYnV0dG9uLm9mZnNldCgpXG4gICAgICAgICAgICBib3guY3NzKHtcbiAgICAgICAgICAgICAgICAnbGVmdCc6IGJ0bk9mZnNldC5sZWZ0IC0gNTIsXG4gICAgICAgICAgICAgICAgJ3RvcCc6IGJ0bk9mZnNldC50b3AgKyAyN1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgLy8gQXMgYSBjbGljayB3aWxsIGNsb3NlIHRoZSBwdWxsZG93biwgd2UgbmVlZCB0byBhY3RpdmF0ZSB0aGUgbGluayBieSBtZWFucyBvZiBhIG1vdXNlZG93biBhbHJlYWR5LlxuICAgICAgICBqUXVlcnkoZG9jdW1lbnQpLm9uKCdtb3VzZWRvd24nLCAnI3VzZXItcHJlZmVyZW5jZXMtcHVsbGRvd24gYScsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSBqUXVlcnkodGhpcykuYXR0cignaHJlZicpXG4gICAgICAgIH0pXG4gICAgICAgIC8vIFNhbWUgZm9yIGZvcm0gYnV0dG9uXG4gICAgICAgIGpRdWVyeShkb2N1bWVudCkub24oJ21vdXNlZG93bicsICcjdXNlci1wcmVmZXJlbmNlcy1wdWxsZG93biBidXR0b25bdHlwZT1cInN1Ym1pdFwiXScsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICBqUXVlcnkodGhpcykuY2xvc2VzdCgnZm9ybScpLnN1Ym1pdCgpXG4gICAgICAgIH0pXG4gICAgfVxufVxuIl19","deps":{"../common":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/common/index.js"}},"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/categories.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/categories.js","source":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ImageOverviewCategories = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _templates = require(\"./templates\");\n\nvar _common = require(\"../../common\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ImageOverviewCategories = exports.ImageOverviewCategories = function () {\n    function ImageOverviewCategories(imageOverview) {\n        _classCallCheck(this, ImageOverviewCategories);\n\n        this.imageOverview = imageOverview;\n        imageOverview.mod.categories = this;\n    }\n    //save changes or create a new category\n\n\n    _createClass(ImageOverviewCategories, [{\n        key: \"createCategory\",\n        value: function createCategory(cats) {\n            var _this = this;\n\n            var postData = {\n                'ids[]': cats.ids,\n                'titles[]': cats.titles\n            };\n            (0, _common.activateWait)();\n            jQuery.ajax({\n                url: '/usermedia/save_category/',\n                data: postData,\n                type: 'POST',\n                dataType: 'json',\n                crossDomain: false, // obviates need for sameOrigin test\n                beforeSend: function beforeSend(xhr, settings) {\n                    return xhr.setRequestHeader(\"X-CSRFToken\", _common.csrfToken);\n                },\n                success: function success(response, textStatus, jqXHR) {\n                    if (jqXHR.status == 201) {\n                        // TODO: Why do we reload the entire list when one new category is created?\n                        _this.imageOverview.imageDB.cats = response.entries;\n                        jQuery('#image-category-list li').not(':first').remove();\n                        _this.addImageCategoryList(response.entries);\n\n                        (0, _common.addAlert)('success', gettext('The categories have been updated'));\n                    }\n                },\n                error: function error(jqXHR, textStatus, errorThrown) {\n                    (0, _common.addAlert)('error', jqXHR.responseText);\n                },\n                complete: function complete() {\n                    return (0, _common.deactivateWait)();\n                }\n            });\n        }\n    }, {\n        key: \"addImageCategoryList\",\n        value: function addImageCategoryList(newimageCategories) {\n            //imageCategories = imageCategories.concat(newimageCategories)\n            for (var i = 0; i < newimageCategories.length; i++) {\n                this.appendToImageCatList(newimageCategories[i]);\n            }\n        }\n    }, {\n        key: \"appendToImageCatList\",\n        value: function appendToImageCatList(iCat) {\n            jQuery('#image-category-list').append((0, _templates.usermediaCategoryListItemTemplate)({\n                'iCat': iCat\n            }));\n        }\n\n        //delete an image category\n\n    }, {\n        key: \"deleteCategory\",\n        value: function deleteCategory(ids) {\n            var postData = {\n                'ids[]': ids\n            };\n            jQuery.ajax({\n                url: '/usermedia/delete_category/',\n                data: postData,\n                type: 'POST',\n                dataType: 'json',\n                crossDomain: false, // obviates need for sameOrigin test\n                beforeSend: function beforeSend(xhr, settings) {\n                    return xhr.setRequestHeader(\"X-CSRFToken\", _common.csrfToken);\n                }\n            });\n        }\n\n        //open a dialog for editing categories\n\n    }, {\n        key: \"createCategoryDialog\",\n        value: function createCategoryDialog() {\n            var dialogHeader = gettext('Edit Categories');\n            var dialogBody = (0, _templates.usermediaEditcategoriesTemplate)({\n                'dialogHeader': dialogHeader,\n                'categories': (0, _templates.usermediaCategoryformsTemplate)({\n                    'categories': this.imageOverview.imageDB.cats\n                })\n            });\n            jQuery('body').append(dialogBody);\n            var diaButtons = {};\n            var that = this;\n            diaButtons[gettext('Submit')] = function () {\n                var newCat = {\n                    'ids': [],\n                    'titles': []\n                };\n                var deletedCats = [];\n                jQuery('#editCategories .category-form').each(function () {\n                    var thisVal = jQuery.trim(jQuery(this).val());\n                    var thisId = jQuery(this).attr('data-id');\n                    if ('undefined' == typeof thisId) thisId = 0;\n                    if ('' !== thisVal) {\n                        newCat.ids.push(thisId);\n                        newCat.titles.push(thisVal);\n                    } else if ('' === thisVal && 0 < thisId) {\n                        deletedCats.push(thisId);\n                    }\n                });\n                that.deleteCategory(deletedCats);\n                that.createCategory(newCat);\n                jQuery(this).dialog('close');\n            };\n            diaButtons[gettext('Cancel')] = function () {\n                jQuery(this).dialog('close');\n            };\n            jQuery(\"#editCategories\").dialog({\n                resizable: false,\n                width: 350,\n                height: 350,\n                modal: true,\n                buttons: diaButtons,\n                create: function create() {\n                    var theDialog = jQuery(this).closest(\".ui-dialog\");\n                    theDialog.find(\".ui-button:first-child\").addClass(\"fw-button fw-dark\");\n                    theDialog.find(\".ui-button:last\").addClass(\"fw-button fw-orange\");\n                },\n                close: function close() {\n                    return jQuery(\"#editCategories\").dialog('destroy').remove();\n                }\n            });\n            this.addRemoveListHandler();\n        }\n    }, {\n        key: \"addRemoveListHandler\",\n        value: function addRemoveListHandler() {\n            //add and remove name list field\n            jQuery('.fw-add-input').bind('click', function () {\n                var parent = jQuery(this).parents('.fw-list-input');\n                if (0 === parent.next().length) {\n                    var parentClone = parent.clone(true);\n                    parentClone.find('input, select').val('').removeAttr('data-id');\n                    parentClone.insertAfter(parent);\n                } else {\n                    var thePrev = jQuery(this).prev();\n                    if (thePrev.hasClass(\"category-form\")) {\n                        // TODO: Figure out what this was about\n                        //let thisId = thePrev.attr('data-id')\n                        //if (undefined !== thisId)\n                        //    deleted_cat[deleted_cat.length] = thisId\n                    }\n                    parent.remove();\n                }\n            });\n            jQuery('.dk').dropkick();\n        }\n    }]);\n\n    return ImageOverviewCategories;\n}();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhdGVnb3JpZXMuanMiXSwibmFtZXMiOlsidXNlcm1lZGlhRWRpdGNhdGVnb3JpZXNUZW1wbGF0ZSIsInVzZXJtZWRpYUNhdGVnb3J5Zm9ybXNUZW1wbGF0ZSIsInVzZXJtZWRpYUNhdGVnb3J5TGlzdEl0ZW1UZW1wbGF0ZSIsImFjdGl2YXRlV2FpdCIsImRlYWN0aXZhdGVXYWl0IiwiYWRkQWxlcnQiLCJjc3JmVG9rZW4iLCJJbWFnZU92ZXJ2aWV3Q2F0ZWdvcmllcyIsImNvbnN0cnVjdG9yIiwiaW1hZ2VPdmVydmlldyIsIm1vZCIsImNhdGVnb3JpZXMiLCJjcmVhdGVDYXRlZ29yeSIsImNhdHMiLCJwb3N0RGF0YSIsImlkcyIsInRpdGxlcyIsImpRdWVyeSIsImFqYXgiLCJ1cmwiLCJkYXRhIiwidHlwZSIsImRhdGFUeXBlIiwiY3Jvc3NEb21haW4iLCJiZWZvcmVTZW5kIiwieGhyIiwic2V0dGluZ3MiLCJzZXRSZXF1ZXN0SGVhZGVyIiwic3VjY2VzcyIsInJlc3BvbnNlIiwidGV4dFN0YXR1cyIsImpxWEhSIiwic3RhdHVzIiwiaW1hZ2VEQiIsImVudHJpZXMiLCJub3QiLCJyZW1vdmUiLCJhZGRJbWFnZUNhdGVnb3J5TGlzdCIsImdldHRleHQiLCJlcnJvciIsImVycm9yVGhyb3duIiwicmVzcG9uc2VUZXh0IiwiY29tcGxldGUiLCJuZXdpbWFnZUNhdGVnb3JpZXMiLCJpIiwibGVuZ3RoIiwiYXBwZW5kVG9JbWFnZUNhdExpc3QiLCJpQ2F0IiwiYXBwZW5kIiwiZGVsZXRlQ2F0ZWdvcnkiLCJjcmVhdGVDYXRlZ29yeURpYWxvZyIsImRpYWxvZ0hlYWRlciIsImRpYWxvZ0JvZHkiLCJkaWFCdXR0b25zIiwidGhhdCIsIm5ld0NhdCIsImRlbGV0ZWRDYXRzIiwiZWFjaCIsInRoaXNWYWwiLCJ0cmltIiwidmFsIiwidGhpc0lkIiwiYXR0ciIsInB1c2giLCJkaWFsb2ciLCJyZXNpemFibGUiLCJ3aWR0aCIsImhlaWdodCIsIm1vZGFsIiwiYnV0dG9ucyIsImNyZWF0ZSIsInRoZURpYWxvZyIsImNsb3Nlc3QiLCJmaW5kIiwiYWRkQ2xhc3MiLCJjbG9zZSIsImFkZFJlbW92ZUxpc3RIYW5kbGVyIiwiYmluZCIsInBhcmVudCIsInBhcmVudHMiLCJuZXh0IiwicGFyZW50Q2xvbmUiLCJjbG9uZSIsInJlbW92ZUF0dHIiLCJpbnNlcnRBZnRlciIsInRoZVByZXYiLCJwcmV2IiwiaGFzQ2xhc3MiLCJkcm9wa2ljayJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsQUFBUSxBQUFpQyxBQUFnQyxBQUF3Qzs7QUFDakgsQUFBUSxBQUFjLEFBQWdCLEFBQVUsQUFBZ0IsQUFFaEUsQUFBTzs7OztJQUFBLEFBQU0sQUFBd0IsQUFFakM7cUNBQUEsQUFBWTtBQUFlLEFBQ3ZCOzthQUFBLEFBQUssZ0JBQUwsQUFBcUIsQUFDckI7c0JBQUEsQUFBYyxJQUFkLEFBQWtCLGFBQWxCLEFBQStCLEFBQ2xDO0FBQ0Q7QUFDQTs7Ozs7dUNBQUEsQUFBZTtBQUFNLEFBQ2pCOztnQkFBSTt5QkFDUyxLQURFLEFBQ0csQUFDZDs0QkFBWSxLQUZoQixBQUFlLEFBRU0sQUFFckI7QUFKZSxBQUNYO0FBSUo7bUJBQUEsQUFBTztxQkFBSyxBQUNILEFBQ0w7c0JBRlEsQUFFRixBQUNOO3NCQUhRLEFBR0YsQUFDTjswQkFKUSxBQUlFLEFBQ1Y7NkJBTFEsQUFLSyxPQUFPLEFBQ3BCO2dEQUFZLEFBQUMsS0FBRCxBQUFNO0FBQU4sMkJBQ1IsSUFBQSxBQUFJLGlCQVBBLEFBT0osQUFBcUIsQUFBZSxBQUN4Qzs7eUJBQVMsaUJBQUEsQUFBQyxVQUFELEFBQVcsWUFBWCxBQUF1QixPQUFVLEFBQ3RDO3dCQUFJLE1BQUEsQUFBTSxVQUFWLEFBQW9CLEtBQUssQUFDckI7QUFDQTs4QkFBQSxBQUFLLGNBQUwsQUFBbUIsUUFBbkIsQUFBMkIsT0FBTyxTQUFsQyxBQUEyQyxBQUMzQzsrQkFBQSxBQUFPLDJCQUFQLEFBQWtDLElBQWxDLEFBQXNDLFVBQXRDLEFBQWdELEFBQ2hEOzhCQUFBLEFB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Q1A7eUJBTDZCLEFBS3BCLEFBQ1Q7d0JBQVEsa0JBQVksQUFDaEI7d0JBQUksWUFBWSxPQUFBLEFBQU8sTUFBUCxBQUFhLFFBQTdCLEFBQWdCLEFBQXFCLEFBQ3JDOzhCQUFBLEFBQVUsS0FBVixBQUFlLDBCQUFmLEFBQXlDLFNBQXpDLEFBQ0ksQUFDSjs4QkFBQSxBQUFVLEtBQVYsQUFBZSxtQkFBZixBQUFrQyxTQUFsQyxBQUNJLEFBQ1A7QUFaNEIsQUFhN0I7O0FBQU8sMkJBQ0gsT0FBQSxBQUFPLG1CQUFQLEFBQTBCLE9BQTFCLEFBQWlDLFdBZHpDLEFBQWlDLEFBY3pCLEFBQTRDLEFBRXBEOztBQWhCaUMsQUFDN0I7aUJBZUosQUFBSyxBQUVSO0FBRUQ7OzsrQ0FBdUIsQUFDbkI7QUFDQTttQkFBQSxBQUFPLGlCQUFQLEFBQXdCLEtBQXhCLEFBQTZCLFNBQVMsWUFBWSxBQUM5QztvQkFBSSxTQUFTLE9BQUEsQUFBTyxNQUFQLEFBQWEsUUFBMUIsQUFBYSxBQUFxQixBQUNsQztvQkFBSSxNQUFNLE9BQUEsQUFBTyxPQUFqQixBQUF3QixRQUFRLEFBQzVCO3dCQUFJLGNBQWMsT0FBQSxBQUFPLE1BQXpCLEFBQWtCLEFBQWEsQUFDL0I7Z0NBQUEsQUFBWSxLQUFaLEFBQWlCLGlCQUFqQixBQUFrQyxJQUFsQyxBQUFzQyxJQUF0QyxBQUEwQyxXQUExQyxBQUNJLEFBQ0o7Z0NBQUEsQUFBWSxZQUFaLEFBQXdCLEFBQzNCO0FBTEQsdUJBS08sQUFDSDt3QkFBSSxVQUFVLE9BQUEsQUFBTyxNQUFyQixBQUFjLEFBQWEsQUFDM0I7d0JBQUksUUFBQSxBQUFRLFNBQVosQUFBSSxBQUFpQixrQkFBa0IsQUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEOzJCQUFBLEFBQU8sQUFDVjtBQUNKO0FBakJELEFBa0JBO21CQUFBLEFBQU8sT0FBUCxBQUFjLEFBQ2pCO0FBbEpnQyIsImZpbGUiOiJjYXRlZ29yaWVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHt1c2VybWVkaWFFZGl0Y2F0ZWdvcmllc1RlbXBsYXRlLCB1c2VybWVkaWFDYXRlZ29yeWZvcm1zVGVtcGxhdGUsIHVzZXJtZWRpYUNhdGVnb3J5TGlzdEl0ZW1UZW1wbGF0ZX0gZnJvbSBcIi4vdGVtcGxhdGVzXCJcbmltcG9ydCB7YWN0aXZhdGVXYWl0LCBkZWFjdGl2YXRlV2FpdCwgYWRkQWxlcnQsIGNzcmZUb2tlbn0gZnJvbSBcIi4uLy4uL2NvbW1vblwiXG5cbmV4cG9ydCBjbGFzcyBJbWFnZU92ZXJ2aWV3Q2F0ZWdvcmllcyB7XG5cbiAgICBjb25zdHJ1Y3RvcihpbWFnZU92ZXJ2aWV3KSB7XG4gICAgICAgIHRoaXMuaW1hZ2VPdmVydmlldyA9IGltYWdlT3ZlcnZpZXdcbiAgICAgICAgaW1hZ2VPdmVydmlldy5tb2QuY2F0ZWdvcmllcyA9IHRoaXNcbiAgICB9XG4gICAgLy9zYXZlIGNoYW5nZXMgb3IgY3JlYXRlIGEgbmV3IGNhdGVnb3J5XG4gICAgY3JlYXRlQ2F0ZWdvcnkoY2F0cykge1xuICAgICAgICBsZXQgcG9zdERhdGEgPSB7XG4gICAgICAgICAgICAnaWRzW10nOiBjYXRzLmlkcyxcbiAgICAgICAgICAgICd0aXRsZXNbXSc6IGNhdHMudGl0bGVzXG4gICAgICAgIH1cbiAgICAgICAgYWN0aXZhdGVXYWl0KClcbiAgICAgICAgalF1ZXJ5LmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnL3VzZXJtZWRpYS9zYXZlX2NhdGVnb3J5LycsXG4gICAgICAgICAgICBkYXRhOiBwb3N0RGF0YSxcbiAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICBjcm9zc0RvbWFpbjogZmFsc2UsIC8vIG9idmlhdGVzIG5lZWQgZm9yIHNhbWVPcmlnaW4gdGVzdFxuICAgICAgICAgICAgYmVmb3JlU2VuZDogKHhociwgc2V0dGluZ3MpID0+XG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJYLUNTUkZUb2tlblwiLCBjc3JmVG9rZW4pLFxuICAgICAgICAgICAgc3VjY2VzczogKHJlc3BvbnNlLCB0ZXh0U3RhdHVzLCBqcVhIUikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChqcVhIUi5zdGF0dXMgPT0gMjAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFdoeSBkbyB3ZSByZWxvYWQgdGhlIGVudGlyZSBsaXN0IHdoZW4gb25lIG5ldyBjYXRlZ29yeSBpcyBjcmVhdGVkP1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmltYWdlT3ZlcnZpZXcuaW1hZ2VEQi5jYXRzID0gcmVzcG9uc2UuZW50cmllc1xuICAgICAgICAgICAgICAgICAgICBqUXVlcnkoJyNpbWFnZS1jYXRlZ29yeS1saXN0IGxpJykubm90KCc6Zmlyc3QnKS5yZW1vdmUoKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZEltYWdlQ2F0ZWdvcnlMaXN0KHJlc3BvbnNlLmVudHJpZXMpXG5cbiAgICAgICAgICAgICAgICAgICAgYWRkQWxlcnQoJ3N1Y2Nlc3MnLCBnZXR0ZXh0KCdUaGUgY2F0ZWdvcmllcyBoYXZlIGJlZW4gdXBkYXRlZCcpKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgPT4ge1xuICAgICAgICAgICAgICAgIGFkZEFsZXJ0KCdlcnJvcicsIGpxWEhSLnJlc3BvbnNlVGV4dClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21wbGV0ZTogKCkgPT4gZGVhY3RpdmF0ZVdhaXQoKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGFkZEltYWdlQ2F0ZWdvcnlMaXN0KG5ld2ltYWdlQ2F0ZWdvcmllcykge1xuICAgICAgICAvL2ltYWdlQ2F0ZWdvcmllcyA9IGltYWdlQ2F0ZWdvcmllcy5jb25jYXQobmV3aW1hZ2VDYXRlZ29yaWVzKVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5ld2ltYWdlQ2F0ZWdvcmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5hcHBlbmRUb0ltYWdlQ2F0TGlzdChuZXdpbWFnZUNhdGVnb3JpZXNbaV0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhcHBlbmRUb0ltYWdlQ2F0TGlzdChpQ2F0KSB7XG4gICAgICAgIGpRdWVyeSgnI2ltYWdlLWNhdGVnb3J5LWxpc3QnKS5hcHBlbmQoXG4gICAgICAgICAgICB1c2VybWVkaWFDYXRlZ29yeUxpc3RJdGVtVGVtcGxhdGUoe1xuICAgICAgICAgICAgICAgICdpQ2F0JzogaUNhdFxuICAgICAgICAgICAgfSkpXG4gICAgfVxuXG4gICAgLy9kZWxldGUgYW4gaW1hZ2UgY2F0ZWdvcnlcblxuICAgIGRlbGV0ZUNhdGVnb3J5KGlkcykge1xuICAgICAgICBsZXQgcG9zdERhdGEgPSB7XG4gICAgICAgICAgICAnaWRzW10nOiBpZHNcbiAgICAgICAgfVxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcvdXNlcm1lZGlhL2RlbGV0ZV9jYXRlZ29yeS8nLFxuICAgICAgICAgICAgZGF0YTogcG9zdERhdGEsXG4gICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgY3Jvc3NEb21haW46IGZhbHNlLCAvLyBvYnZpYXRlcyBuZWVkIGZvciBzYW1lT3JpZ2luIHRlc3RcbiAgICAgICAgICAgIGJlZm9yZVNlbmQ6ICh4aHIsIHNldHRpbmdzKSA9PlxuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiWC1DU1JGVG9rZW5cIiwgY3NyZlRva2VuKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8vb3BlbiBhIGRpYWxvZyBmb3IgZWRpdGluZyBjYXRlZ29yaWVzXG4gICAgY3JlYXRlQ2F0ZWdvcnlEaWFsb2coKSB7XG4gICAgICAgIGxldCBkaWFsb2dIZWFkZXIgPSBnZXR0ZXh0KCdFZGl0IENhdGVnb3JpZXMnKVxuICAgICAgICBsZXQgZGlhbG9nQm9keSA9IHVzZXJtZWRpYUVkaXRjYXRlZ29yaWVzVGVtcGxhdGUoe1xuICAgICAgICAgICAgJ2RpYWxvZ0hlYWRlcic6IGRpYWxvZ0hlYWRlcixcbiAgICAgICAgICAgICdjYXRlZ29yaWVzJzogdXNlcm1lZGlhQ2F0ZWdvcnlmb3Jtc1RlbXBsYXRlKHtcbiAgICAgICAgICAgICAgICAnY2F0ZWdvcmllcyc6IHRoaXMuaW1hZ2VPdmVydmlldy5pbWFnZURCLmNhdHNcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIGpRdWVyeSgnYm9keScpLmFwcGVuZChkaWFsb2dCb2R5KVxuICAgICAgICBsZXQgZGlhQnV0dG9ucyA9IHt9XG4gICAgICAgIGxldCB0aGF0ID0gdGhpc1xuICAgICAgICBkaWFCdXR0b25zW2dldHRleHQoJ1N1Ym1pdCcpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCBuZXdDYXQgPSB7XG4gICAgICAgICAgICAgICAgJ2lkcyc6IFtdLFxuICAgICAgICAgICAgICAgICd0aXRsZXMnOiBbXVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGRlbGV0ZWRDYXRzID0gW11cbiAgICAgICAgICAgIGpRdWVyeSgnI2VkaXRDYXRlZ29yaWVzIC5jYXRlZ29yeS1mb3JtJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IHRoaXNWYWwgPSBqUXVlcnkudHJpbShqUXVlcnkodGhpcykudmFsKCkpXG4gICAgICAgICAgICAgICAgbGV0IHRoaXNJZCA9IGpRdWVyeSh0aGlzKS5hdHRyKCdkYXRhLWlkJylcbiAgICAgICAgICAgICAgICBpZiAoJ3VuZGVmaW5lZCcgPT0gdHlwZW9mICh0aGlzSWQpKSB0aGlzSWQgPSAwXG4gICAgICAgICAgICAgICAgaWYgKCcnICE9PSB0aGlzVmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NhdC5pZHMucHVzaCh0aGlzSWQpXG4gICAgICAgICAgICAgICAgICAgIG5ld0NhdC50aXRsZXMucHVzaCh0aGlzVmFsKVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJycgPT09IHRoaXNWYWwgJiYgMCA8IHRoaXNJZCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGVkQ2F0cy5wdXNoKHRoaXNJZClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgdGhhdC5kZWxldGVDYXRlZ29yeShkZWxldGVkQ2F0cylcbiAgICAgICAgICAgIHRoYXQuY3JlYXRlQ2F0ZWdvcnkobmV3Q2F0KVxuICAgICAgICAgICAgalF1ZXJ5KHRoaXMpLmRpYWxvZygnY2xvc2UnKVxuICAgICAgICB9XG4gICAgICAgIGRpYUJ1dHRvbnNbZ2V0dGV4dCgnQ2FuY2VsJyldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgalF1ZXJ5KHRoaXMpLmRpYWxvZygnY2xvc2UnKVxuICAgICAgICB9XG4gICAgICAgIGpRdWVyeShcIiNlZGl0Q2F0ZWdvcmllc1wiKS5kaWFsb2coe1xuICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHdpZHRoOiAzNTAsXG4gICAgICAgICAgICBoZWlnaHQ6IDM1MCxcbiAgICAgICAgICAgIG1vZGFsOiB0cnVlLFxuICAgICAgICAgICAgYnV0dG9uczogZGlhQnV0dG9ucyxcbiAgICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCB0aGVEaWFsb2cgPSBqUXVlcnkodGhpcykuY2xvc2VzdChcIi51aS1kaWFsb2dcIilcbiAgICAgICAgICAgICAgICB0aGVEaWFsb2cuZmluZChcIi51aS1idXR0b246Zmlyc3QtY2hpbGRcIikuYWRkQ2xhc3MoXG4gICAgICAgICAgICAgICAgICAgIFwiZnctYnV0dG9uIGZ3LWRhcmtcIilcbiAgICAgICAgICAgICAgICB0aGVEaWFsb2cuZmluZChcIi51aS1idXR0b246bGFzdFwiKS5hZGRDbGFzcyhcbiAgICAgICAgICAgICAgICAgICAgXCJmdy1idXR0b24gZnctb3JhbmdlXCIpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2xvc2U6ICgpID0+XG4gICAgICAgICAgICAgICAgalF1ZXJ5KFwiI2VkaXRDYXRlZ29yaWVzXCIpLmRpYWxvZygnZGVzdHJveScpLnJlbW92ZSgpXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMuYWRkUmVtb3ZlTGlzdEhhbmRsZXIoKVxuXG4gICAgfVxuXG4gICAgYWRkUmVtb3ZlTGlzdEhhbmRsZXIoKSB7XG4gICAgICAgIC8vYWRkIGFuZCByZW1vdmUgbmFtZSBsaXN0IGZpZWxkXG4gICAgICAgIGpRdWVyeSgnLmZ3LWFkZC1pbnB1dCcpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGV0IHBhcmVudCA9IGpRdWVyeSh0aGlzKS5wYXJlbnRzKCcuZnctbGlzdC1pbnB1dCcpXG4gICAgICAgICAgICBpZiAoMCA9PT0gcGFyZW50Lm5leHQoKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBsZXQgcGFyZW50Q2xvbmUgPSBwYXJlbnQuY2xvbmUodHJ1ZSlcbiAgICAgICAgICAgICAgICBwYXJlbnRDbG9uZS5maW5kKCdpbnB1dCwgc2VsZWN0JykudmFsKCcnKS5yZW1vdmVBdHRyKFxuICAgICAgICAgICAgICAgICAgICAnZGF0YS1pZCcpXG4gICAgICAgICAgICAgICAgcGFyZW50Q2xvbmUuaW5zZXJ0QWZ0ZXIocGFyZW50KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgdGhlUHJldiA9IGpRdWVyeSh0aGlzKS5wcmV2KClcbiAgICAgICAgICAgICAgICBpZiAodGhlUHJldi5oYXNDbGFzcyhcImNhdGVnb3J5LWZvcm1cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogRmlndXJlIG91dCB3aGF0IHRoaXMgd2FzIGFib3V0XG4gICAgICAgICAgICAgICAgICAgIC8vbGV0IHRoaXNJZCA9IHRoZVByZXYuYXR0cignZGF0YS1pZCcpXG4gICAgICAgICAgICAgICAgICAgIC8vaWYgKHVuZGVmaW5lZCAhPT0gdGhpc0lkKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICBkZWxldGVkX2NhdFtkZWxldGVkX2NhdC5sZW5ndGhdID0gdGhpc0lkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBhcmVudC5yZW1vdmUoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBqUXVlcnkoJy5kaycpLmRyb3BraWNrKClcbiAgICB9XG5cbn1cbiJdfQ==","deps":{"./templates":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/templates.js","../../common":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/common/index.js"}},"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/upload-dialog/templates.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/upload-dialog/templates.js","source":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/* A template for the form for the image upload dialog. */\nvar usermediaUploadTemplate = exports.usermediaUploadTemplate = _.template('<div id=\"uploadimage\" class=\"fw-media-uploader\" title=\"<%- action %>\">\\\n    <form action=\"#\" method=\"post\" class=\"usermediaUploadForm\">\\\n        <div>\\\n            <input name=\"title\" class=\"fw-media-title fw-media-form\" type=\"text\" placeholder=\"' + gettext('Insert a title') + '\" value=\"<%- title %>\" />\\\n            <button type=\"button\" class=\"fw-media-select-button fw-button fw-light\">' + gettext('Select a file') + '</button>\\\n            <input name=\"image\" type=\"file\" class=\"fw-media-file-input fw-media-form\">\\\n        </div>\\\n        <div class=\"figure-preview\"><div>\\\n            <% if(image) { %><img src=\"<%- image %>\" /><% } %>\\\n        </div></div>\\\n        <%= categories %>\\\n    </form></div>');\n\n/* A template for the image category selection of the image selection dialog. */\nvar usermediaUploadCategoryTemplate = exports.usermediaUploadCategoryTemplate = _.template('<% if(0 < categories.length) { %>\\\n        <div class=\"fw-media-category\">\\\n            <div><%- fieldTitle %></div>\\\n            <% _.each(categories, function(cat) { %>\\\n                <label class=\"fw-checkable fw-checkable-label<%- cat.checked %>\" for=\"imageCat<%- cat.id %>\">\\\n                    <%- cat.category_title %>\\\n                </label>\\\n                <input class=\"fw-checkable-input fw-media-form entry-cat\" type=\"checkbox\"\\\n                    id=\"imageCat<%- cat.id %>\" name=\"imageCat\" value=\"<%- cat.id %>\"<%- cat.checked %>>\\\n            <% }); %>\\\n        </div>\\\n    <% } %>');\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlbXBsYXRlcy5qcyJdLCJuYW1lcyI6WyJ1c2VybWVkaWFVcGxvYWRUZW1wbGF0ZSIsIl8iLCJ0ZW1wbGF0ZSIsImdldHRleHQiLCJ1c2VybWVkaWFVcGxvYWRDYXRlZ29yeVRlbXBsYXRlIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLEFBQ0E7QUFBTyxJQUFJLDhEQUEwQixBQUFFLFNBQVM7OztrR0FHa0QsUUFIbEQsQUFHa0QsQUFBUSxvQkFIMUQsQUFHOEU7d0ZBRTlHLFFBTGdDLEFBS2hDLEFBQVEsbUJBTGpCLEFBQThCLEFBTXpCOzs7Ozs7O2tCQU55Qjs7QUFlckMsQUFDQTtBQUFPLElBQUksOEVBQWtDLEFBQUUsU0FBeEMsQUFBc0MsQUFBVzs7Ozs7Ozs7Ozs7WUFBWCIsImZpbGUiOiJ0ZW1wbGF0ZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBBIHRlbXBsYXRlIGZvciB0aGUgZm9ybSBmb3IgdGhlIGltYWdlIHVwbG9hZCBkaWFsb2cuICovXG5leHBvcnQgbGV0IHVzZXJtZWRpYVVwbG9hZFRlbXBsYXRlID0gXy50ZW1wbGF0ZSgnPGRpdiBpZD1cInVwbG9hZGltYWdlXCIgY2xhc3M9XCJmdy1tZWRpYS11cGxvYWRlclwiIHRpdGxlPVwiPCUtIGFjdGlvbiAlPlwiPlxcXG4gICAgPGZvcm0gYWN0aW9uPVwiI1wiIG1ldGhvZD1cInBvc3RcIiBjbGFzcz1cInVzZXJtZWRpYVVwbG9hZEZvcm1cIj5cXFxuICAgICAgICA8ZGl2PlxcXG4gICAgICAgICAgICA8aW5wdXQgbmFtZT1cInRpdGxlXCIgY2xhc3M9XCJmdy1tZWRpYS10aXRsZSBmdy1tZWRpYS1mb3JtXCIgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cIicgKyBnZXR0ZXh0KCdJbnNlcnQgYSB0aXRsZScpICsgJ1wiIHZhbHVlPVwiPCUtIHRpdGxlICU+XCIgLz5cXFxuICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJmdy1tZWRpYS1zZWxlY3QtYnV0dG9uIGZ3LWJ1dHRvbiBmdy1saWdodFwiPicgK1xuICAgICAgICAgICAgICAgIGdldHRleHQoJ1NlbGVjdCBhIGZpbGUnKSArXG4gICAgICAgICAgICAnPC9idXR0b24+XFxcbiAgICAgICAgICAgIDxpbnB1dCBuYW1lPVwiaW1hZ2VcIiB0eXBlPVwiZmlsZVwiIGNsYXNzPVwiZnctbWVkaWEtZmlsZS1pbnB1dCBmdy1tZWRpYS1mb3JtXCI+XFxcbiAgICAgICAgPC9kaXY+XFxcbiAgICAgICAgPGRpdiBjbGFzcz1cImZpZ3VyZS1wcmV2aWV3XCI+PGRpdj5cXFxuICAgICAgICAgICAgPCUgaWYoaW1hZ2UpIHsgJT48aW1nIHNyYz1cIjwlLSBpbWFnZSAlPlwiIC8+PCUgfSAlPlxcXG4gICAgICAgIDwvZGl2PjwvZGl2PlxcXG4gICAgICAgIDwlPSBjYXRlZ29yaWVzICU+XFxcbiAgICA8L2Zvcm0+PC9kaXY+JylcblxuLyogQSB0ZW1wbGF0ZSBmb3IgdGhlIGltYWdlIGNhdGVnb3J5IHNlbGVjdGlvbiBvZiB0aGUgaW1hZ2Ugc2VsZWN0aW9uIGRpYWxvZy4gKi9cbmV4cG9ydCBsZXQgdXNlcm1lZGlhVXBsb2FkQ2F0ZWdvcnlUZW1wbGF0ZSA9IF8udGVtcGxhdGUoJzwlIGlmKDAgPCBjYXRlZ29yaWVzLmxlbmd0aCkgeyAlPlxcXG4gICAgICAgIDxkaXYgY2xhc3M9XCJmdy1tZWRpYS1jYXRlZ29yeVwiPlxcXG4gICAgICAgICAgICA8ZGl2PjwlLSBmaWVsZFRpdGxlICU+PC9kaXY+XFxcbiAgICAgICAgICAgIDwlIF8uZWFjaChjYXRlZ29yaWVzLCBmdW5jdGlvbihjYXQpIHsgJT5cXFxuICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cImZ3LWNoZWNrYWJsZSBmdy1jaGVja2FibGUtbGFiZWw8JS0gY2F0LmNoZWNrZWQgJT5cIiBmb3I9XCJpbWFnZUNhdDwlLSBjYXQuaWQgJT5cIj5cXFxuICAgICAgICAgICAgICAgICAgICA8JS0gY2F0LmNhdGVnb3J5X3RpdGxlICU+XFxcbiAgICAgICAgICAgICAgICA8L2xhYmVsPlxcXG4gICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwiZnctY2hlY2thYmxlLWlucHV0IGZ3LW1lZGlhLWZvcm0gZW50cnktY2F0XCIgdHlwZT1cImNoZWNrYm94XCJcXFxuICAgICAgICAgICAgICAgICAgICBpZD1cImltYWdlQ2F0PCUtIGNhdC5pZCAlPlwiIG5hbWU9XCJpbWFnZUNhdFwiIHZhbHVlPVwiPCUtIGNhdC5pZCAlPlwiPCUtIGNhdC5jaGVja2VkICU+PlxcXG4gICAgICAgICAgICA8JSB9KTsgJT5cXFxuICAgICAgICA8L2Rpdj5cXFxuICAgIDwlIH0gJT4nKVxuIl19","deps":{}},"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/upload-dialog/index.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/upload-dialog/index.js","source":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ImageUploadDialog = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _templates = require(\"./templates\");\n\nvar _common = require(\"../../common\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ImageUploadDialog = exports.ImageUploadDialog = function () {\n    function ImageUploadDialog(imageDB, imageId, ownerId) {\n        _classCallCheck(this, ImageUploadDialog);\n\n        this.imageDB = imageDB;\n        this.imageId = imageId;\n        this.ownerId = ownerId;\n    }\n\n    //open a dialog for uploading an image\n\n\n    _createClass(ImageUploadDialog, [{\n        key: \"init\",\n        value: function init() {\n            var _this = this;\n\n            var title = void 0,\n                imageCat = void 0,\n                thumbnail = void 0,\n                image = void 0,\n                action = void 0,\n                longAction = void 0;\n            if (this.imageId) {\n                title = this.imageDB.db[this.imageId].title;\n                thumbnail = this.imageDB.db[this.imageId].thumbnail;\n                image = this.imageDB.db[this.imageId].image;\n                imageCat = this.imageDB.db[this.imageId].cats;\n                action = gettext('Update');\n                longAction = gettext('Update image');\n            } else {\n                this.imageId = 0;\n                title = '';\n                imageCat = [];\n                thumbnail = false;\n                image = false;\n                action = gettext('Upload');\n                longAction = gettext('Upload image');\n            }\n\n            var iCats = [];\n            jQuery.each(this.imageDB.cats, function (i, iCat) {\n                var len = iCats.length;\n                iCats[len] = {\n                    'id': iCat.id,\n                    'category_title': iCat.category_title\n                };\n                if (0 <= jQuery.inArray(String(iCat.id), imageCat)) {\n                    iCats[len].checked = ' checked';\n                } else {\n                    iCats[len].checked = '';\n                }\n            });\n\n            jQuery('body').append((0, _templates.usermediaUploadTemplate)({\n                'action': longAction,\n                'title': title,\n                'thumbnail': thumbnail,\n                'image': image,\n                'categories': (0, _templates.usermediaUploadCategoryTemplate)({\n                    'categories': iCats,\n                    'fieldTitle': gettext('Select categories')\n                })\n            }));\n            var diaButtons = {};\n\n            var returnPromise = new Promise(function (resolve) {\n                diaButtons[action] = function () {\n                    return resolve(_this.onCreateImageSubmitHandler());\n                };\n\n                diaButtons[gettext('Cancel')] = function () {\n                    jQuery(this).dialog('close');\n                    resolve((0, _common.cancelPromise)());\n                };\n            });\n\n            var that = this;\n            jQuery(\"#uploadimage\").dialog({\n                resizable: false,\n                height: 'auto',\n                width: 'auto',\n                modal: true,\n                buttons: diaButtons,\n                create: function create() {\n                    var theDialog = jQuery(this).closest(\".ui-dialog\");\n                    theDialog.find(\".ui-button:first-child\").addClass(\"fw-button fw-dark\");\n                    theDialog.find(\".ui-button:last\").addClass(\"fw-button fw-orange\");\n                    that.setMediaUploadEvents(jQuery('#uploadimage'));\n                },\n                close: function close() {\n                    return jQuery(\"#uploadimage\").dialog('destroy').remove();\n                }\n\n            });\n\n            jQuery('.fw-checkable-label').bind('click', function () {\n                (0, _common.setCheckableLabel)(jQuery(this));\n            });\n            return returnPromise;\n        }\n\n        //add image upload events\n\n    }, {\n        key: \"setMediaUploadEvents\",\n        value: function setMediaUploadEvents(wrapper) {\n            var selectButton = wrapper.find('.fw-media-select-button'),\n                mediaInput = wrapper.find('.fw-media-file-input'),\n                mediaPreviewer = wrapper.find('.figure-preview > div');\n\n            selectButton.bind('click', function () {\n                return mediaInput.trigger('click');\n            });\n\n            mediaInput.bind('change', function () {\n                var file = jQuery(this).prop('files')[0],\n                    fr = new window.FileReader();\n\n                fr.onload = function () {\n                    mediaPreviewer.html('<img src=\"' + fr.result + '\" />');\n                };\n                fr.readAsDataURL(file);\n            });\n        }\n    }, {\n        key: \"onCreateImageSubmitHandler\",\n        value: function onCreateImageSubmitHandler() {\n            //when submitted, the values in form elements will be restored\n            var formValues = new window.FormData(),\n                checkboxValues = {};\n\n            formValues.append('id', this.imageId);\n\n            if (this.ownerId) {\n                formValues.append('owner_id', this.ownerId);\n            }\n\n            jQuery('.fw-media-form').each(function () {\n                var $this = jQuery(this);\n                var theName = $this.attr('name') || $this.attr('data-field-name');\n                var theType = $this.attr('type') || $this.attr('data-type');\n                var theValue = '';\n\n                switch (theType) {\n                    case 'checkbox':\n                        //if it is a checkbox, the value will be restored as an Array\n                        if (undefined === checkboxValues[theName]) checkboxValues[theName] = [];\n                        if ($this.prop(\"checked\")) {\n                            checkboxValues[theName].push($this.val());\n                        }\n                        return;\n                    case 'file':\n                        theValue = $this.get(0).files[0];\n                        break;\n                    default:\n                        theValue = $this.val();\n                }\n\n                formValues.append(theName, theValue);\n            });\n\n            // Add the values for check boxes\n            for (var key in checkboxValues) {\n                formValues.append(key, checkboxValues[key].join(','));\n            }\n            return this.createImage(formValues);\n        }\n    }, {\n        key: \"createImage\",\n        value: function createImage(imageData) {\n            var _this2 = this;\n\n            return new Promise(function (resolve) {\n                _this2.imageDB.createImage(imageData).then(function (imageId) {\n                    jQuery(\"#uploadimage\").dialog('close');\n                    _this2.imageId = imageId;\n                    resolve(imageId);\n                });\n            });\n        }\n    }]);\n\n    return ImageUploadDialog;\n}();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInVzZXJtZWRpYVVwbG9hZENhdGVnb3J5VGVtcGxhdGUiLCJ1c2VybWVkaWFVcGxvYWRUZW1wbGF0ZSIsInNldENoZWNrYWJsZUxhYmVsIiwiY2FuY2VsUHJvbWlzZSIsIkltYWdlVXBsb2FkRGlhbG9nIiwiY29uc3RydWN0b3IiLCJpbWFnZURCIiwiaW1hZ2VJZCIsIm93bmVySWQiLCJpbml0IiwidGl0bGUiLCJpbWFnZUNhdCIsInRodW1ibmFpbCIsImltYWdlIiwiYWN0aW9uIiwibG9uZ0FjdGlvbiIsImRiIiwiY2F0cyIsImdldHRleHQiLCJpQ2F0cyIsImpRdWVyeSIsImVhY2giLCJpIiwiaUNhdCIsImxlbiIsImxlbmd0aCIsImlkIiwiY2F0ZWdvcnlfdGl0bGUiLCJpbkFycmF5IiwiU3RyaW5nIiwiY2hlY2tlZCIsImFwcGVuZCIsImRpYUJ1dHRvbnMiLCJyZXR1cm5Qcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJvbkNyZWF0ZUltYWdlU3VibWl0SGFuZGxlciIsImRpYWxvZyIsInRoYXQiLCJyZXNpemFibGUiLCJoZWlnaHQiLCJ3aWR0aCIsIm1vZGFsIiwiYnV0dG9ucyIsImNyZWF0ZSIsInRoZURpYWxvZyIsImNsb3Nlc3QiLCJmaW5kIiwiYWRkQ2xhc3MiLCJzZXRNZWRpYVVwbG9hZEV2ZW50cyIsImNsb3NlIiwicmVtb3ZlIiwiYmluZCIsIndyYXBwZXIiLCJzZWxlY3RCdXR0b24iLCJtZWRpYUlucHV0IiwibWVkaWFQcmV2aWV3ZXIiLCJ0cmlnZ2VyIiwiZmlsZSIsInByb3AiLCJmciIsIndpbmRvdyIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJodG1sIiwicmVzdWx0IiwicmVhZEFzRGF0YVVSTCIsImZvcm1WYWx1ZXMiLCJGb3JtRGF0YSIsImNoZWNrYm94VmFsdWVzIiwiJHRoaXMiLCJ0aGVOYW1lIiwiYXR0ciIsInRoZVR5cGUiLCJ0aGVWYWx1ZSIsInVuZGVmaW5lZCIsInB1c2giLCJ2YWwiLCJnZXQiLCJmaWxlcyIsImtleSIsImpvaW4iLCJjcmVhdGVJbWFnZSIsImltYWdlRGF0YSIsInRoZW4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLEFBQVEsQUFBaUMsQUFBOEI7O0FBQ3ZFLEFBQVEsQUFBbUIsQUFBb0IsQUFFL0MsQUFBTzs7OztJQUFBLEFBQU0sQUFBa0IsQUFDM0I7K0JBQUEsQUFBWSxTQUFaLEFBQXFCLFNBQXJCLEFBQThCO0FBQVMsQUFDbkM7O2FBQUEsQUFBSyxVQUFMLEFBQWUsQUFDZjthQUFBLEFBQUssVUFBTCxBQUFlLEFBQ2Y7YUFBQSxBQUFLLFVBQUwsQUFBZSxBQUNsQjtBQUVEOztBQUNBOzs7Ozs7QUFBTyxBQUNIOztnQkFBQSxBQUFJO2dCQUFKLEFBQVc7Z0JBQVgsQUFBcUI7Z0JBQXJCLEFBQWdDO2dCQUFoQyxBQUF1QztnQkFBdkMsQUFBK0MsQUFDL0M7Z0JBQUksS0FBSixBQUFTLFNBQVMsQUFDZDt3QkFBUSxLQUFBLEFBQUssUUFBTCxBQUFhLEdBQUcsS0FBaEIsQUFBcUIsU0FBN0IsQUFBc0MsQUFDdEM7NEJBQVksS0FBQSxBQUFLLFFBQUwsQUFBYSxHQUFHLEtBQWhCLEFBQXFCLFNBQWpDLEFBQTBDLEFBQzFDO3dCQUFRLEtBQUEsQUFBSyxRQUFMLEFBQWEsR0FBRyxLQUFoQixBQUFxQixTQUE3QixBQUFzQyxBQUN0QzsyQkFBVyxLQUFBLEFBQUssUUFBTCxBQUFhLEdBQUcsS0FBaEIsQUFBcUIsU0FBaEMsQUFBeUMsQUFDekM7eUJBQVMsUUFBVCxBQUFTLEFBQVEsQUFDakI7NkJBQWEsUUFBYixBQUFhLEFBQVEsQUFDeEI7QUFQRCxtQkFPTyxBQUNIO3FCQUFBLEFBQUssVUFBTCxBQUFlLEFBQ2Y7d0JBQUEsQUFBUSxBQUNSOzJCQUFBLEFBQVcsQUFDWDs0QkFBQSxBQUFZLEFBQ1o7d0JBQUEsQUFBUSxBQUNSO3lCQUFTLFFBQVQsQUFBUyxBQUFRLEFBQ2pCOzZCQUFhLFFBQWIsQUFBYSxBQUFRLEFBQ3hCO0FBRUQ7O2dCQUFJLFFBQUosQUFBWSxBQUNaO21CQUFBLEFBQU8sS0FBSyxLQUFBLEFBQUssUUFBakIsQUFBeUIsTUFBTSxVQUFBLEFBQUMsR0FBRCxBQUFJLE1BQVMsQUFDeEM7b0JBQUksTUFBTSxNQUFWLEFBQWdCLEFBQ2hCO3NCQUFBLEFBQU07MEJBQ0ksS0FERyxBQUNFLEFBQ1g7c0NBQWtCLEtBRnRCLEFBQWEsQUFFYyxBQUUzQjtBQUphLEFBQ1Q7b0JBR0EsS0FBSyxPQUFBLEFBQU8sUUFBUSxPQUFPLEtBQXRCLEFBQWUsQUFBWSxLQUFwQyxBQUFTLEFBQWdDLFdBQVcsQUFDaEQ7MEJBQUEsQUFBTSxLQUFOLEFBQVcsVUFBWCxBQUFxQixBQUN4QjtBQUZELHVCQUVPLEFBQ0g7MEJBQUEsQUFBTSxLQUFOLEFBQVcsVUFBWCxBQUFxQixBQUN4QjtBQUNKO0FBWEQsQUFhQTs7bUJBQUEsQUFBTyxRQUFQLEFBQWU7MEJBQStCLEFBQ2hDLEFBQ1Y7eUJBRjBDLEFBRWpDLEFBQ1Q7NkJBSDBDLEFBRzdCLEFBQ2I7eUJBSjBDLEFBSWpDLEFBQ1Q7O2tDQUE4QyxBQUM1QixBQUNkO2tDQUFjLFFBUHRCLEFBQXNCLEFBQXdCLEFBSzVCLEFBQWdDLEFBRTVCLEFBQVEsQUFHOUI7QUFMa0QsQUFDMUMsaUJBRFU7QUFMNEIsQUFDMUMsYUFEa0I7Z0JBVWxCLGFBQUosQUFBaUIsQUFFakI7O2dCQUFJLG9CQUFnQixBQUFJLFFBQVEsbUJBQVcsQUFDdkM7MkJBQUEsQUFBVztBQUFVLDJCQUFNLFFBQVEsTUFBbkMsQUFBMkIsQUFBUSxBQUFLLEFBRXhDOzs7MkJBQVcsUUFBWCxBQUFXLEFBQVEsYUFBYSxZQUFZLEFBQ3hDOzJCQUFBLEFBQU8sTUFBUCxBQUFhLE9BQWIsQUFBb0IsQUFDcEI7NEJBQUEsQUFBUSxBQUNYO0FBSEQsQUFJSDtBQVBELEFBQW9CLEFBU3BCLGFBVG9COztnQkFTaEIsT0FBSixBQUFXLEFBQ1g7bUJBQUEsQUFBTyxnQkFBUCxBQUF1QjsyQkFBTyxBQUNmLEFBQ1g7d0JBRjBCLEFBRWxCLEFBQ1I7dUJBSDBCLEFBR25CLEFBQ1A7dUJBSjBCLEFBSW5CLEFBQ1A7eUJBTDBCLEFBS2pCLEFBQ1Q7d0JBQVEsa0JBQVksQUFDaEI7d0JBQUksWUFBWSxPQUFBLEFBQU8sTUFBUCxBQUFhLFFBQTdCLEFBQWdCLEFBQXFCLEFBQ3JDOzhCQUFBLEFBQVUsS0FBVixBQUFlLDBCQUFmLEFBQXlDLFNBQXpDLEFBQWtELEFBQ2xEOzhCQUFBLEFBQVUsS0FBVixBQUFlLG1CQUFmLEFBQWtDLFNBQWxDLEFBQTJDLEFBQzNDO3lCQUFBLEFBQUsscUJBQXFCLE9BQTFCLEFBQTBCLEFBQU8sQUFDcEM7QUFYeUIsQUFZMUI7O0FBQU8sMkJBQU0sT0FBQSxBQUFPLGdCQUFQLEFBQXVCLE9BQXZCLEFBQThCLFdBWi9DLEFBQThCLEFBWWIsQUFBeUMsQUFJMUQ7OztBQWhCOEIsQUFDMUI7O21CQWVKLEFBQU8sdUJBQVAsQUFBOEIsS0FBOUIsQUFBbUMsU0FBUyxZQUFZLEFBQ3BEOytDQUFrQixPQUFsQixBQUFrQixBQUFPLEFBQzVCO0FBRkQsQUFHQTttQkFBQSxBQUFPLEFBQ1Y7QUFFRDs7QUFDQTs7Ozs2Q0FBQSxBQUFxQixTQUFTLEFBQzFCO2dCQUFJLGVBQWUsUUFBQSxBQUFRLEtBQTNCLEFBQW1CLEFBQWE7Z0JBQzVCLGFBQWEsUUFBQSxBQUFRLEtBRHpCLEFBQ2lCLEFBQWE7Z0JBQzFCLGlCQUFpQixRQUFBLEFBQVEsS0FGN0IsQUFFcUIsQUFBYSxBQUVsQzs7eUJBQUEsQUFBYSxLQUFiLEFBQWtCO0FBQVMsdUJBQU0sV0FBQSxBQUFXLFFBQTVDLEFBQWlDLEFBQW1CLEFBRXBEOzs7dUJBQUEsQUFBVyxLQUFYLEFBQWdCLFVBQVUsWUFBVyxBQUNqQztvQkFBSSxPQUFPLE9BQUEsQUFBTyxNQUFQLEFBQWEsS0FBYixBQUFrQixTQUE3QixBQUFXLEFBQTJCO29CQUNsQyxLQUFLLElBQUksT0FEYixBQUNTLEFBQVcsQUFFcEI7O21CQUFBLEFBQUcsU0FBUyxZQUFNLEFBQ2Q7bUNBQUEsQUFBZSxLQUFLLGVBQWUsR0FBZixBQUFrQixTQUF0QyxBQUErQyxBQUNsRDtBQUZELEFBR0E7bUJBQUEsQUFBRyxjQUFILEFBQWlCLEFBQ3BCO0FBUkQsQUFTSDtBQUVEOzs7cURBQTZCLEFBQ3pCO0FBQ0E7Z0JBQUksYUFBYSxJQUFJLE9BQXJCLEFBQWlCLEFBQVc7Z0JBQ3hCLGlCQURKLEFBQ3FCLEFBRXJCOzt1QkFBQSxBQUFXLE9BQVgsQUFBa0IsTUFBTSxLQUF4QixBQUE2QixBQUU3Qjs7Z0JBQUcsS0FBSCxBQUFRLFNBQVMsQUFDYjsyQkFBQSxBQUFXLE9BQVgsQUFBa0IsWUFBWSxLQUE5QixBQUFtQyxBQUN0QztBQUVEOzttQkFBQSxBQUFPLGtCQUFQLEFBQXlCLEtBQUssWUFBWSxBQUN0QztvQkFBSSxRQUFRLE9BQVosQUFBWSxBQUFPLEFBQ25CO29CQUFJLFVBQVUsTUFBQSxBQUFNLEtBQU4sQUFBVyxXQUFXLE1BQUEsQUFBTSxLQUExQyxBQUFvQyxBQUFXLEFBQy9DO29CQUFJLFVBQVUsTUFBQSxBQUFNLEtBQU4sQUFBVyxXQUFXLE1BQUEsQUFBTSxLQUExQyxBQUFvQyxBQUFXLEFBQy9DO29CQUFJLFdBQUosQUFBZSxBQUVmOzt3QkFBQSxBQUFRLEFBQ0o7eUJBQUEsQUFBSyxBQUNEO0FBQ0E7NEJBQUksY0FBYyxlQUFsQixBQUFrQixBQUFlLFVBQzdCLGVBQUEsQUFBZSxXQUFmLEFBQTBCLEFBQzlCOzRCQUFJLE1BQUEsQUFBTSxLQUFWLEFBQUksQUFBVyxZQUFZLEFBQ3ZCOzJDQUFBLEFBQWUsU0FBZixBQUF3QixLQUFLLE1BQTdCLEFBQTZCLEFBQU0sQUFDdEM7QUFDRDtBQUNKO3lCQUFBLEFBQUssQUFDRDttQ0FBVyxNQUFBLEFBQU0sSUFBTixBQUFVLEdBQVYsQUFBYSxNQUF4QixBQUFXLEFBQW1CLEFBQzlCO0FBQ0o7QUFDSTttQ0FBVyxNQWJuQixBQWFRLEFBQVcsQUFBTSxBQUd6Qjs7OzJCQUFBLEFBQVcsT0FBWCxBQUFrQixTQUFsQixBQUEyQixBQUM5QjtBQXZCRCxBQXlCQTs7QUFDQTtpQkFBSyxJQUFMLEFBQVMsT0FBVCxBQUFnQixnQkFBZ0IsQUFDNUI7MkJBQUEsQUFBVyxPQUFYLEFBQWtCLEtBQUssZUFBQSxBQUFlLEtBQWYsQUFBb0IsS0FBM0MsQUFBdUIsQUFBeUIsQUFDbkQ7QUFDRDttQkFBTyxLQUFBLEFBQUssWUFBWixBQUFPLEFBQWlCLEFBQzNCO0FBRUQ7OztvQ0FBQSxBQUFZO0FBQVcsQUFDbkI7O3VCQUFPLEFBQUksUUFBUSxtQkFBVyxBQUMxQjt1QkFBQSxBQUFLLFFBQUwsQUFBYSxZQUFiLEFBQXlCLFdBQXpCLEFBQW9DLEtBQUssbUJBQVcsQUFDaEQ7MkJBQUEsQUFBTyxnQkFBUCxBQUF1QixPQUF2QixBQUE4QixBQUM5QjsyQkFBQSxBQUFLLFVBQUwsQUFBZSxBQUNmOzRCQUFBLEFBQVEsQUFDWDtBQUpELEFBS0g7QUFORCxBQUFPLEFBT1YsYUFQVTtBQXBKZ0IiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3VzZXJtZWRpYVVwbG9hZENhdGVnb3J5VGVtcGxhdGUsIHVzZXJtZWRpYVVwbG9hZFRlbXBsYXRlfSBmcm9tIFwiLi90ZW1wbGF0ZXNcIlxuaW1wb3J0IHtzZXRDaGVja2FibGVMYWJlbCwgY2FuY2VsUHJvbWlzZX0gZnJvbSBcIi4uLy4uL2NvbW1vblwiXG5cbmV4cG9ydCBjbGFzcyBJbWFnZVVwbG9hZERpYWxvZyB7XG4gICAgY29uc3RydWN0b3IoaW1hZ2VEQiwgaW1hZ2VJZCwgb3duZXJJZCkge1xuICAgICAgICB0aGlzLmltYWdlREIgPSBpbWFnZURCXG4gICAgICAgIHRoaXMuaW1hZ2VJZCA9IGltYWdlSWRcbiAgICAgICAgdGhpcy5vd25lcklkID0gb3duZXJJZFxuICAgIH1cblxuICAgIC8vb3BlbiBhIGRpYWxvZyBmb3IgdXBsb2FkaW5nIGFuIGltYWdlXG4gICAgaW5pdCgpIHtcbiAgICAgICAgbGV0IHRpdGxlLCBpbWFnZUNhdCwgdGh1bWJuYWlsLCBpbWFnZSwgYWN0aW9uLCBsb25nQWN0aW9uXG4gICAgICAgIGlmICh0aGlzLmltYWdlSWQpIHtcbiAgICAgICAgICAgIHRpdGxlID0gdGhpcy5pbWFnZURCLmRiW3RoaXMuaW1hZ2VJZF0udGl0bGVcbiAgICAgICAgICAgIHRodW1ibmFpbCA9IHRoaXMuaW1hZ2VEQi5kYlt0aGlzLmltYWdlSWRdLnRodW1ibmFpbFxuICAgICAgICAgICAgaW1hZ2UgPSB0aGlzLmltYWdlREIuZGJbdGhpcy5pbWFnZUlkXS5pbWFnZVxuICAgICAgICAgICAgaW1hZ2VDYXQgPSB0aGlzLmltYWdlREIuZGJbdGhpcy5pbWFnZUlkXS5jYXRzXG4gICAgICAgICAgICBhY3Rpb24gPSBnZXR0ZXh0KCdVcGRhdGUnKVxuICAgICAgICAgICAgbG9uZ0FjdGlvbiA9IGdldHRleHQoJ1VwZGF0ZSBpbWFnZScpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmltYWdlSWQgPSAwXG4gICAgICAgICAgICB0aXRsZSA9ICcnXG4gICAgICAgICAgICBpbWFnZUNhdCA9IFtdXG4gICAgICAgICAgICB0aHVtYm5haWwgPSBmYWxzZVxuICAgICAgICAgICAgaW1hZ2UgPSBmYWxzZVxuICAgICAgICAgICAgYWN0aW9uID0gZ2V0dGV4dCgnVXBsb2FkJylcbiAgICAgICAgICAgIGxvbmdBY3Rpb24gPSBnZXR0ZXh0KCdVcGxvYWQgaW1hZ2UnKVxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGlDYXRzID0gW11cbiAgICAgICAgalF1ZXJ5LmVhY2godGhpcy5pbWFnZURCLmNhdHMsIChpLCBpQ2F0KSA9PiB7XG4gICAgICAgICAgICBsZXQgbGVuID0gaUNhdHMubGVuZ3RoXG4gICAgICAgICAgICBpQ2F0c1tsZW5dID0ge1xuICAgICAgICAgICAgICAgICdpZCc6IGlDYXQuaWQsXG4gICAgICAgICAgICAgICAgJ2NhdGVnb3J5X3RpdGxlJzogaUNhdC5jYXRlZ29yeV90aXRsZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKDAgPD0galF1ZXJ5LmluQXJyYXkoU3RyaW5nKGlDYXQuaWQpLCBpbWFnZUNhdCkpIHtcbiAgICAgICAgICAgICAgICBpQ2F0c1tsZW5dLmNoZWNrZWQgPSAnIGNoZWNrZWQnXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlDYXRzW2xlbl0uY2hlY2tlZCA9ICcnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgalF1ZXJ5KCdib2R5JykuYXBwZW5kKHVzZXJtZWRpYVVwbG9hZFRlbXBsYXRlKHtcbiAgICAgICAgICAgICdhY3Rpb24nOiBsb25nQWN0aW9uLFxuICAgICAgICAgICAgJ3RpdGxlJzogdGl0bGUsXG4gICAgICAgICAgICAndGh1bWJuYWlsJzogdGh1bWJuYWlsLFxuICAgICAgICAgICAgJ2ltYWdlJzogaW1hZ2UsXG4gICAgICAgICAgICAnY2F0ZWdvcmllcyc6IHVzZXJtZWRpYVVwbG9hZENhdGVnb3J5VGVtcGxhdGUoe1xuICAgICAgICAgICAgICAgICdjYXRlZ29yaWVzJzogaUNhdHMsXG4gICAgICAgICAgICAgICAgJ2ZpZWxkVGl0bGUnOiBnZXR0ZXh0KCdTZWxlY3QgY2F0ZWdvcmllcycpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KSlcbiAgICAgICAgbGV0IGRpYUJ1dHRvbnMgPSB7fVxuXG4gICAgICAgIGxldCByZXR1cm5Qcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICBkaWFCdXR0b25zW2FjdGlvbl0gPSAoKSA9PiByZXNvbHZlKHRoaXMub25DcmVhdGVJbWFnZVN1Ym1pdEhhbmRsZXIoKSlcblxuICAgICAgICAgICAgZGlhQnV0dG9uc1tnZXR0ZXh0KCdDYW5jZWwnKV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5KHRoaXMpLmRpYWxvZygnY2xvc2UnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoY2FuY2VsUHJvbWlzZSgpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIGxldCB0aGF0ID0gdGhpc1xuICAgICAgICBqUXVlcnkoXCIjdXBsb2FkaW1hZ2VcIikuZGlhbG9nKHtcbiAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXG4gICAgICAgICAgICBoZWlnaHQ6ICdhdXRvJyxcbiAgICAgICAgICAgIHdpZHRoOiAnYXV0bycsXG4gICAgICAgICAgICBtb2RhbDogdHJ1ZSxcbiAgICAgICAgICAgIGJ1dHRvbnM6IGRpYUJ1dHRvbnMsXG4gICAgICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsZXQgdGhlRGlhbG9nID0galF1ZXJ5KHRoaXMpLmNsb3Nlc3QoXCIudWktZGlhbG9nXCIpXG4gICAgICAgICAgICAgICAgdGhlRGlhbG9nLmZpbmQoXCIudWktYnV0dG9uOmZpcnN0LWNoaWxkXCIpLmFkZENsYXNzKFwiZnctYnV0dG9uIGZ3LWRhcmtcIilcbiAgICAgICAgICAgICAgICB0aGVEaWFsb2cuZmluZChcIi51aS1idXR0b246bGFzdFwiKS5hZGRDbGFzcyhcImZ3LWJ1dHRvbiBmdy1vcmFuZ2VcIilcbiAgICAgICAgICAgICAgICB0aGF0LnNldE1lZGlhVXBsb2FkRXZlbnRzKGpRdWVyeSgnI3VwbG9hZGltYWdlJykpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2xvc2U6ICgpID0+IGpRdWVyeShcIiN1cGxvYWRpbWFnZVwiKS5kaWFsb2coJ2Rlc3Ryb3knKS5yZW1vdmUoKVxuXG4gICAgICAgIH0pXG5cbiAgICAgICAgalF1ZXJ5KCcuZnctY2hlY2thYmxlLWxhYmVsJykuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXRDaGVja2FibGVMYWJlbChqUXVlcnkodGhpcykpXG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiByZXR1cm5Qcm9taXNlXG4gICAgfVxuXG4gICAgLy9hZGQgaW1hZ2UgdXBsb2FkIGV2ZW50c1xuICAgIHNldE1lZGlhVXBsb2FkRXZlbnRzKHdyYXBwZXIpIHtcbiAgICAgICAgbGV0IHNlbGVjdEJ1dHRvbiA9IHdyYXBwZXIuZmluZCgnLmZ3LW1lZGlhLXNlbGVjdC1idXR0b24nKSxcbiAgICAgICAgICAgIG1lZGlhSW5wdXQgPSB3cmFwcGVyLmZpbmQoJy5mdy1tZWRpYS1maWxlLWlucHV0JyksXG4gICAgICAgICAgICBtZWRpYVByZXZpZXdlciA9IHdyYXBwZXIuZmluZCgnLmZpZ3VyZS1wcmV2aWV3ID4gZGl2JylcblxuICAgICAgICBzZWxlY3RCdXR0b24uYmluZCgnY2xpY2snLCAoKSA9PiBtZWRpYUlucHV0LnRyaWdnZXIoJ2NsaWNrJykpXG5cbiAgICAgICAgbWVkaWFJbnB1dC5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxldCBmaWxlID0galF1ZXJ5KHRoaXMpLnByb3AoJ2ZpbGVzJylbMF0sXG4gICAgICAgICAgICAgICAgZnIgPSBuZXcgd2luZG93LkZpbGVSZWFkZXIoKVxuXG4gICAgICAgICAgICBmci5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbWVkaWFQcmV2aWV3ZXIuaHRtbCgnPGltZyBzcmM9XCInICsgZnIucmVzdWx0ICsgJ1wiIC8+JylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZyLnJlYWRBc0RhdGFVUkwoZmlsZSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBvbkNyZWF0ZUltYWdlU3VibWl0SGFuZGxlcigpIHtcbiAgICAgICAgLy93aGVuIHN1Ym1pdHRlZCwgdGhlIHZhbHVlcyBpbiBmb3JtIGVsZW1lbnRzIHdpbGwgYmUgcmVzdG9yZWRcbiAgICAgICAgbGV0IGZvcm1WYWx1ZXMgPSBuZXcgd2luZG93LkZvcm1EYXRhKCksXG4gICAgICAgICAgICBjaGVja2JveFZhbHVlcyA9IHt9XG5cbiAgICAgICAgZm9ybVZhbHVlcy5hcHBlbmQoJ2lkJywgdGhpcy5pbWFnZUlkKVxuXG4gICAgICAgIGlmKHRoaXMub3duZXJJZCkge1xuICAgICAgICAgICAgZm9ybVZhbHVlcy5hcHBlbmQoJ293bmVyX2lkJywgdGhpcy5vd25lcklkKVxuICAgICAgICB9XG5cbiAgICAgICAgalF1ZXJ5KCcuZnctbWVkaWEtZm9ybScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGV0ICR0aGlzID0galF1ZXJ5KHRoaXMpXG4gICAgICAgICAgICBsZXQgdGhlTmFtZSA9ICR0aGlzLmF0dHIoJ25hbWUnKSB8fCAkdGhpcy5hdHRyKCdkYXRhLWZpZWxkLW5hbWUnKVxuICAgICAgICAgICAgbGV0IHRoZVR5cGUgPSAkdGhpcy5hdHRyKCd0eXBlJykgfHwgJHRoaXMuYXR0cignZGF0YS10eXBlJylcbiAgICAgICAgICAgIGxldCB0aGVWYWx1ZSA9ICcnXG5cbiAgICAgICAgICAgIHN3aXRjaCAodGhlVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcbiAgICAgICAgICAgICAgICAgICAgLy9pZiBpdCBpcyBhIGNoZWNrYm94LCB0aGUgdmFsdWUgd2lsbCBiZSByZXN0b3JlZCBhcyBhbiBBcnJheVxuICAgICAgICAgICAgICAgICAgICBpZiAodW5kZWZpbmVkID09PSBjaGVja2JveFZhbHVlc1t0aGVOYW1lXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrYm94VmFsdWVzW3RoZU5hbWVdID0gW11cbiAgICAgICAgICAgICAgICAgICAgaWYgKCR0aGlzLnByb3AoXCJjaGVja2VkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2JveFZhbHVlc1t0aGVOYW1lXS5wdXNoKCR0aGlzLnZhbCgpKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgIGNhc2UgJ2ZpbGUnOlxuICAgICAgICAgICAgICAgICAgICB0aGVWYWx1ZSA9ICR0aGlzLmdldCgwKS5maWxlc1swXVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRoZVZhbHVlID0gJHRoaXMudmFsKClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9ybVZhbHVlcy5hcHBlbmQodGhlTmFtZSwgdGhlVmFsdWUpXG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gQWRkIHRoZSB2YWx1ZXMgZm9yIGNoZWNrIGJveGVzXG4gICAgICAgIGZvciAobGV0IGtleSBpbiBjaGVja2JveFZhbHVlcykge1xuICAgICAgICAgICAgZm9ybVZhbHVlcy5hcHBlbmQoa2V5LCBjaGVja2JveFZhbHVlc1trZXldLmpvaW4oJywnKSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVJbWFnZShmb3JtVmFsdWVzKVxuICAgIH1cblxuICAgIGNyZWF0ZUltYWdlKGltYWdlRGF0YSkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmltYWdlREIuY3JlYXRlSW1hZ2UoaW1hZ2VEYXRhKS50aGVuKGltYWdlSWQgPT4ge1xuICAgICAgICAgICAgICAgIGpRdWVyeShcIiN1cGxvYWRpbWFnZVwiKS5kaWFsb2coJ2Nsb3NlJylcbiAgICAgICAgICAgICAgICB0aGlzLmltYWdlSWQgPSBpbWFnZUlkXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShpbWFnZUlkKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbn1cbiJdfQ==","deps":{"../../common":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/common/index.js","./templates":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/upload-dialog/templates.js"}},"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/index.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/index.js","source":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ImageOverview = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _uploadDialog = require(\"../upload-dialog\");\n\nvar _database = require(\"../database\");\n\nvar _categories = require(\"./categories\");\n\nvar _common = require(\"../../common\");\n\nvar _menu = require(\"../../menu\");\n\nvar _templates = require(\"./templates\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/** Helper functions for user added images/SVGs.*/\n\nvar ImageOverview = exports.ImageOverview = function () {\n    function ImageOverview() {\n        _classCallCheck(this, ImageOverview);\n\n        this.mod = {};\n        new _categories.ImageOverviewCategories(this);\n        new _menu.Menu(\"images\");\n        this.bind();\n    }\n\n    //delete image\n\n\n    _createClass(ImageOverview, [{\n        key: \"deleteImage\",\n        value: function deleteImage(ids) {\n            var _this = this;\n\n            for (var i = 0; i < ids.length; i++) {\n                ids[i] = parseInt(ids[i]);\n            }\n            var postData = {\n                'ids[]': ids\n            };\n            (0, _common.activateWait)();\n            jQuery.ajax({\n                url: '/usermedia/delete/',\n                data: postData,\n                type: 'POST',\n                crossDomain: false, // obviates need for sameOrigin test\n                beforeSend: function beforeSend(xhr, settings) {\n                    return xhr.setRequestHeader(\"X-CSRFToken\", _common.csrfToken);\n                },\n                success: function success(response, textStatus, jqXHR) {\n                    _this.stopUsermediaTable();\n                    var len = ids.length;\n                    for (var _i = 0; _i < len; _i++) {\n                        delete _this.imageDB[ids[_i]];\n                    }\n                    var elementsId = '#Image_' + ids.join(', #Image_');\n                    jQuery(elementsId).detach();\n                    _this.startUsermediaTable();\n                    (0, _common.addAlert)('success', gettext('The image(s) have been deleted'));\n                },\n                error: function error(jqXHR, textStatus, errorThrown) {\n                    (0, _common.addAlert)('error', jqXHR.responseText);\n                },\n                complete: function complete() {\n                    (0, _common.deactivateWait)();\n                }\n            });\n        }\n    }, {\n        key: \"deleteImageDialog\",\n        value: function deleteImageDialog(ids) {\n            jQuery('body').append('<div id=\"confirmdeletion\" title=\"' + gettext('Confirm deletion') + '\"><p>' + gettext('Delete the image(s)') + '?</p></div>');\n            var diaButtons = {};\n            var that = this;\n            diaButtons[gettext('Delete')] = function () {\n                that.deleteImage(ids);\n                jQuery(this).dialog('close');\n            };\n            diaButtons[gettext('Cancel')] = function () {\n                jQuery(this).dialog('close');\n            };\n            jQuery(\"#confirmdeletion\").dialog({\n                resizable: false,\n                height: 180,\n                modal: true,\n                buttons: diaButtons,\n                create: function create() {\n                    var theDialog = jQuery(this).closest(\".ui-dialog\");\n                    theDialog.find(\".ui-button:first-child\").addClass(\"fw-button fw-dark\");\n                    theDialog.find(\".ui-button:last\").addClass(\"fw-button fw-orange\");\n                },\n                close: function close() {\n                    jQuery(\"#confirmdeletion\").dialog('destroy').remove();\n                }\n            });\n        }\n    }, {\n        key: \"addImageDB\",\n        value: function addImageDB(imagePks) {\n            for (var i = 0; i < imagePks.length; i++) {\n                this.appendToImageTable(imagePks[i]);\n            }\n            this.startUsermediaTable();\n        }\n    }, {\n        key: \"appendToImageTable\",\n        value: function appendToImageTable(pk) {\n            var imageInfo = this.imageDB.db[pk];\n            var $tr = jQuery('#Image_' + pk);\n            var fileType = imageInfo.file_type.split('/');\n\n            if (1 < fileType.length) {\n                fileType = fileType[1].toUpperCase();\n            } else {\n                fileType = fileType[0].toUpperCase();\n            }\n\n            if (0 < $tr.length) {\n                //if the image entry exists, update\n                $tr.replaceWith((0, _templates.usermediaTableTemplate)({\n                    pk: pk,\n                    'cats': imageInfo.cats,\n                    fileType: fileType,\n                    'title': imageInfo.title,\n                    'thumbnail': imageInfo.thumbnail,\n                    'image': imageInfo.image,\n                    'height': imageInfo.height,\n                    'width': imageInfo.width,\n                    'added': imageInfo.added,\n                    localizeDate: _common.localizeDate\n                }));\n            } else {\n                //if this is the new image, append\n                jQuery('#imagelist > tbody').append((0, _templates.usermediaTableTemplate)({\n                    pk: pk,\n                    'cats': imageInfo.cats,\n                    fileType: fileType,\n                    'title': imageInfo.title,\n                    'thumbnail': imageInfo.thumbnail,\n                    'image': imageInfo.image,\n                    'height': imageInfo.height,\n                    'width': imageInfo.width,\n                    'added': imageInfo.added,\n                    localizeDate: _common.localizeDate\n                }));\n            }\n        }\n    }, {\n        key: \"getImageDB\",\n        value: function getImageDB() {\n            var _this2 = this;\n\n            var imageGetter = new _database.ImageDB(0);\n            imageGetter.getDB().then(function (pks) {\n                _this2.imageDB = imageGetter;\n                _this2.mod.categories.addImageCategoryList(imageGetter.cats);\n                _this2.addImageDB(pks);\n            });\n        }\n    }, {\n        key: \"stopUsermediaTable\",\n        value: function stopUsermediaTable() {\n            jQuery('#imagelist').dataTable().fnDestroy();\n        }\n    }, {\n        key: \"startUsermediaTable\",\n        value: function startUsermediaTable() {\n            /* The sortable table seems not to have an option to accept new data\n            added to the DOM. Instead we destroy and recreate it.\n            */\n\n            jQuery('#imagelist').dataTable({\n                \"bPaginate\": false,\n                \"bLengthChange\": false,\n                \"bFilter\": true,\n                \"bInfo\": false,\n                \"bAutoWidth\": false,\n                \"oLanguage\": {\n                    \"sSearch\": ''\n                },\n                \"aoColumnDefs\": [{\n                    \"bSortable\": false,\n                    \"aTargets\": [0, 2, 4]\n                }]\n            });\n            jQuery('#imagelist_filter input').attr('placeholder', gettext('Search for Filename'));\n\n            jQuery('#imagelist_filter input').unbind('focus, blur');\n            jQuery('#imagelist_filter input').bind('focus', function () {\n                jQuery(this).parent().addClass('focus');\n            });\n            jQuery('#imagelist_filter input').bind('blur', function () {\n                jQuery(this).parent().removeClass('focus');\n            });\n\n            var autocompleteTags = [];\n            jQuery('#imagelist .fw-searchable').each(function () {\n                autocompleteTags.push(this.textContent.replace(/^\\s+/g, '').replace(/\\s+$/g, ''));\n            });\n            autocompleteTags = _.uniq(autocompleteTags);\n            jQuery(\"#imagelist_filter input\").autocomplete({\n                source: autocompleteTags\n            });\n        }\n    }, {\n        key: \"bindEvents\",\n        value: function bindEvents() {\n            var _this3 = this;\n\n            var that = this;\n            jQuery(document).on('click', '.delete-image', function () {\n                var ImageId = jQuery(this).attr('data-id');\n                that.deleteImageDialog([ImageId]);\n            });\n\n            jQuery(document).on('click', '.edit-image', function () {\n                var iID = parseInt(jQuery(this).attr('data-id'));\n                var iType = jQuery(this).attr('data-type');\n                var imageUpload = new _uploadDialog.ImageUploadDialog(that.imageDB, iID, 0);\n                imageUpload.init().then(function (imageId) {\n                    that.stopUsermediaTable();\n                    that.appendToImageTable(imageId);\n                    that.startUsermediaTable();\n                });\n            });\n            jQuery('#edit-category').bind('click', function () {\n                _this3.mod.categories.createCategoryDialog();\n            });\n            //open dropdown for image category\n            (0, _common.addDropdownBox)(jQuery('#image-category-btn'), jQuery('#image-category-pulldown'));\n            jQuery(document).on('mousedown', '#image-category-pulldown li > span', function () {\n                jQuery('#image-category-btn > label').html(jQuery(this).html());\n                jQuery('#image-category').val(jQuery(this).attr('data-id'));\n                jQuery('#image-category').trigger('change');\n            });\n            //filtering function for the list of images\n            jQuery('#image-category').bind('change', function () {\n                var catVal = jQuery(this).val();\n                if ('0' === catVal) {\n                    jQuery('#imagelist > tbody > tr').show();\n                } else {\n                    jQuery('#imagelist > tbody > tr').hide();\n                    jQuery('#imagelist > tbody > tr.cat_' + catVal).show();\n                }\n            });\n            //select all entries\n            jQuery('#select-all-entry').bind('change', function () {\n                var newBool = false;\n                if (jQuery(this).prop(\"checked\")) newBool = true;\n                jQuery('.entry-select').each(function () {\n                    this.checked = newBool;\n                });\n            });\n            //open dropdown for selecting action\n            (0, _common.addDropdownBox)(jQuery('#select-action-dropdown'), jQuery('#action-selection-pulldown'));\n            //submit image actions\n            jQuery('#action-selection-pulldown li > span').bind('mousedown', function () {\n                var actionName = jQuery(this).attr('data-action'),\n                    ids = [];\n                if ('' === actionName || 'undefined' == typeof actionName) return;\n                jQuery('.entry-select:checked').each(function () {\n                    ids[ids.length] = jQuery(this).attr('data-id');\n                });\n                if (0 === ids.length) return;\n                switch (actionName) {\n                    case 'delete':\n                        that.deleteImageDialog(ids);\n                        break;\n                }\n            });\n        }\n    }, {\n        key: \"init\",\n        value: function init() {\n            this.bindEvents();\n            this.getImageDB();\n        }\n    }, {\n        key: \"bind\",\n        value: function bind() {\n            var _this4 = this;\n\n            jQuery(document).ready(function () {\n                _this4.init();\n            });\n        }\n    }]);\n\n    return ImageOverview;\n}();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkltYWdlVXBsb2FkRGlhbG9nIiwiSW1hZ2VEQiIsIkltYWdlT3ZlcnZpZXdDYXRlZ29yaWVzIiwiYWRkRHJvcGRvd25Cb3giLCJhY3RpdmF0ZVdhaXQiLCJkZWFjdGl2YXRlV2FpdCIsImFkZEFsZXJ0IiwibG9jYWxpemVEYXRlIiwiY3NyZlRva2VuIiwiTWVudSIsInVzZXJtZWRpYUNhdGVnb3J5TGlzdEl0ZW0iLCJ1c2VybWVkaWFUYWJsZVRlbXBsYXRlIiwiSW1hZ2VPdmVydmlldyIsImNvbnN0cnVjdG9yIiwibW9kIiwiYmluZCIsImRlbGV0ZUltYWdlIiwiaWRzIiwiaSIsImxlbmd0aCIsInBhcnNlSW50IiwicG9zdERhdGEiLCJqUXVlcnkiLCJhamF4IiwidXJsIiwiZGF0YSIsInR5cGUiLCJjcm9zc0RvbWFpbiIsImJlZm9yZVNlbmQiLCJ4aHIiLCJzZXR0aW5ncyIsInNldFJlcXVlc3RIZWFkZXIiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJ0ZXh0U3RhdHVzIiwianFYSFIiLCJzdG9wVXNlcm1lZGlhVGFibGUiLCJsZW4iLCJpbWFnZURCIiwiZWxlbWVudHNJZCIsImpvaW4iLCJkZXRhY2giLCJzdGFydFVzZXJtZWRpYVRhYmxlIiwiZ2V0dGV4dCIsImVycm9yIiwiZXJyb3JUaHJvd24iLCJyZXNwb25zZVRleHQiLCJjb21wbGV0ZSIsImRlbGV0ZUltYWdlRGlhbG9nIiwiYXBwZW5kIiwiZGlhQnV0dG9ucyIsInRoYXQiLCJkaWFsb2ciLCJyZXNpemFibGUiLCJoZWlnaHQiLCJtb2RhbCIsImJ1dHRvbnMiLCJjcmVhdGUiLCJ0aGVEaWFsb2ciLCJjbG9zZXN0IiwiZmluZCIsImFkZENsYXNzIiwiY2xvc2UiLCJyZW1vdmUiLCJhZGRJbWFnZURCIiwiaW1hZ2VQa3MiLCJhcHBlbmRUb0ltYWdlVGFibGUiLCJwayIsImltYWdlSW5mbyIsImRiIiwiJHRyIiwiZmlsZVR5cGUiLCJmaWxlX3R5cGUiLCJzcGxpdCIsInRvVXBwZXJDYXNlIiwicmVwbGFjZVdpdGgiLCJjYXRzIiwidGl0bGUiLCJ0aHVtYm5haWwiLCJpbWFnZSIsIndpZHRoIiwiYWRkZWQiLCJnZXRJbWFnZURCIiwiaW1hZ2VHZXR0ZXIiLCJnZXREQiIsInRoZW4iLCJwa3MiLCJjYXRlZ29yaWVzIiwiYWRkSW1hZ2VDYXRlZ29yeUxpc3QiLCJkYXRhVGFibGUiLCJmbkRlc3Ryb3kiLCJhdHRyIiwidW5iaW5kIiwicGFyZW50IiwicmVtb3ZlQ2xhc3MiLCJhdXRvY29tcGxldGVUYWdzIiwiZWFjaCIsInB1c2giLCJ0ZXh0Q29udGVudCIsInJlcGxhY2UiLCJfIiwidW5pcSIsImF1dG9jb21wbGV0ZSIsInNvdXJjZSIsImJpbmRFdmVudHMiLCJkb2N1bWVudCIsIm9uIiwiSW1hZ2VJZCIsImlJRCIsImlUeXBlIiwiaW1hZ2VVcGxvYWQiLCJpbml0IiwiaW1hZ2VJZCIsImNyZWF0ZUNhdGVnb3J5RGlhbG9nIiwiaHRtbCIsInZhbCIsInRyaWdnZXIiLCJjYXRWYWwiLCJzaG93IiwiaGlkZSIsIm5ld0Jvb2wiLCJwcm9wIiwiY2hlY2tlZCIsImFjdGlvbk5hbWUiLCJyZWFkeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsQUFBUSxBQUF3Qjs7QUFDaEMsQUFBUSxBQUFjOztBQUN0QixBQUFRLEFBQThCOztBQUN0QyxBQUFRLEFBQWdCLEFBQWMsQUFBZ0IsQUFBVSxBQUFjLEFBQWdCOztBQUM5RixBQUFRLEFBQVc7O0FBQ25CLEFBQVEsQUFBMkIsQUFBNkI7Ozs7QUFDL0QsQUFFRCxBQUFPOztJQUFBLEFBQU0sQUFBYyxBQUN2Qjs7QUFBYyxBQUNWOzthQUFBLEFBQUssTUFBTCxBQUFXLEFBQ1g7QUFBQSxBQUFJLGdEQUFKLEFBQTRCLEFBQzVCO0FBQUEsQUFBSSx1QkFBSixBQUFTLEFBQ1Q7YUFBQSxBQUFLLEFBQ1I7QUFFRDs7QUFDQTs7Ozs7b0NBQUEsQUFBWTtBQUFLLEFBQ2I7O2lCQUFLLElBQUksSUFBVCxBQUFhLEdBQUcsSUFBSSxJQUFwQixB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QUM1QyxBQUNKO3VCQUFBLEFBQU8seUJBQVAsQUFBZ0MsS0FBSyxZQUFZLEFBQzdDO3dCQUFJLElBQUosQUFBUSxVQUFVLE9BQUEsQUFBTyxNQUFQLEFBQWEsS0FBL0IsQUFBa0IsQUFBa0IsQUFDdkM7QUFGRCxBQUdBO29CQUFJLE1BQU0sSUFBVixBQUFjLFFBQ1YsQUFDSjt3QkFBQSxBQUFRLEFBQ1I7eUJBQUEsQUFBSyxBQUNEOzZCQUFBLEFBQUssa0JBQUwsQUFBdUIsQUFDdkI7QUFISixBQUtIOztBQWZELEFBZ0JIO0FBRUQ7OzsrQkFBTyxBQUNIO2lCQUFBLEFBQUssQUFDTDtpQkFBQSxBQUFLLEFBQ1I7QUFFRDs7OztBQUFPLEFBQ0g7O21CQUFBLEFBQU8sVUFBUCxBQUFpQixNQUFNLFlBQU0sQUFDekI7dUJBQUEsQUFBSyxBQUNSO0FBRkQsQUFHSDtBQXZRc0IiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0ltYWdlVXBsb2FkRGlhbG9nfSBmcm9tIFwiLi4vdXBsb2FkLWRpYWxvZ1wiXG5pbXBvcnQge0ltYWdlREJ9IGZyb20gXCIuLi9kYXRhYmFzZVwiXG5pbXBvcnQge0ltYWdlT3ZlcnZpZXdDYXRlZ29yaWVzfSBmcm9tIFwiLi9jYXRlZ29yaWVzXCJcbmltcG9ydCB7YWRkRHJvcGRvd25Cb3gsIGFjdGl2YXRlV2FpdCwgZGVhY3RpdmF0ZVdhaXQsIGFkZEFsZXJ0LCBsb2NhbGl6ZURhdGUsIGNzcmZUb2tlbn0gZnJvbSBcIi4uLy4uL2NvbW1vblwiXG5pbXBvcnQge01lbnV9IGZyb20gXCIuLi8uLi9tZW51XCJcbmltcG9ydCB7dXNlcm1lZGlhQ2F0ZWdvcnlMaXN0SXRlbSwgdXNlcm1lZGlhVGFibGVUZW1wbGF0ZX0gZnJvbSBcIi4vdGVtcGxhdGVzXCJcbiAvKiogSGVscGVyIGZ1bmN0aW9ucyBmb3IgdXNlciBhZGRlZCBpbWFnZXMvU1ZHcy4qL1xuXG5leHBvcnQgY2xhc3MgSW1hZ2VPdmVydmlldyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMubW9kID0ge31cbiAgICAgICAgbmV3IEltYWdlT3ZlcnZpZXdDYXRlZ29yaWVzKHRoaXMpXG4gICAgICAgIG5ldyBNZW51KFwiaW1hZ2VzXCIpXG4gICAgICAgIHRoaXMuYmluZCgpXG4gICAgfVxuXG4gICAgLy9kZWxldGUgaW1hZ2VcbiAgICBkZWxldGVJbWFnZShpZHMpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlkc1tpXSA9IHBhcnNlSW50KGlkc1tpXSlcbiAgICAgICAgfVxuICAgICAgICBsZXQgcG9zdERhdGEgPSB7XG4gICAgICAgICAgICAnaWRzW10nOiBpZHNcbiAgICAgICAgfVxuICAgICAgICBhY3RpdmF0ZVdhaXQoKVxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcvdXNlcm1lZGlhL2RlbGV0ZS8nLFxuICAgICAgICAgICAgZGF0YTogcG9zdERhdGEsXG4gICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICBjcm9zc0RvbWFpbjogZmFsc2UsIC8vIG9idmlhdGVzIG5lZWQgZm9yIHNhbWVPcmlnaW4gdGVzdFxuICAgICAgICAgICAgYmVmb3JlU2VuZDogKHhociwgc2V0dGluZ3MpID0+XG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJYLUNTUkZUb2tlblwiLCBjc3JmVG9rZW4pLFxuICAgICAgICAgICAgc3VjY2VzczogKHJlc3BvbnNlLCB0ZXh0U3RhdHVzLCBqcVhIUikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcFVzZXJtZWRpYVRhYmxlKClcbiAgICAgICAgICAgICAgICBsZXQgbGVuID0gaWRzLmxlbmd0aFxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuaW1hZ2VEQltpZHNbaV1dXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBlbGVtZW50c0lkID0gJyNJbWFnZV8nICsgaWRzLmpvaW4oJywgI0ltYWdlXycpXG4gICAgICAgICAgICAgICAgalF1ZXJ5KGVsZW1lbnRzSWQpLmRldGFjaCgpXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydFVzZXJtZWRpYVRhYmxlKClcbiAgICAgICAgICAgICAgICBhZGRBbGVydCgnc3VjY2VzcycsIGdldHRleHQoJ1RoZSBpbWFnZShzKSBoYXZlIGJlZW4gZGVsZXRlZCcpKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XG4gICAgICAgICAgICAgICAgYWRkQWxlcnQoJ2Vycm9yJywganFYSFIucmVzcG9uc2VUZXh0KVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZGVhY3RpdmF0ZVdhaXQoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGRlbGV0ZUltYWdlRGlhbG9nKGlkcykge1xuICAgICAgICBqUXVlcnkoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJjb25maXJtZGVsZXRpb25cIiB0aXRsZT1cIicgKyBnZXR0ZXh0KFxuICAgICAgICAgICAgICAgICdDb25maXJtIGRlbGV0aW9uJykgKyAnXCI+PHA+JyArIGdldHRleHQoXG4gICAgICAgICAgICAgICAgJ0RlbGV0ZSB0aGUgaW1hZ2UocyknKSArXG4gICAgICAgICAgICAnPzwvcD48L2Rpdj4nKVxuICAgICAgICBsZXQgZGlhQnV0dG9ucyA9IHt9XG4gICAgICAgIGxldCB0aGF0ID0gdGhpc1xuICAgICAgICBkaWFCdXR0b25zW2dldHRleHQoJ0RlbGV0ZScpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoYXQuZGVsZXRlSW1hZ2UoaWRzKVxuICAgICAgICAgICAgalF1ZXJ5KHRoaXMpLmRpYWxvZygnY2xvc2UnKVxuICAgICAgICB9XG4gICAgICAgIGRpYUJ1dHRvbnNbZ2V0dGV4dCgnQ2FuY2VsJyldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgalF1ZXJ5KHRoaXMpLmRpYWxvZygnY2xvc2UnKVxuICAgICAgICB9XG4gICAgICAgIGpRdWVyeShcIiNjb25maXJtZGVsZXRpb25cIikuZGlhbG9nKHtcbiAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXG4gICAgICAgICAgICBoZWlnaHQ6IDE4MCxcbiAgICAgICAgICAgIG1vZGFsOiB0cnVlLFxuICAgICAgICAgICAgYnV0dG9uczogZGlhQnV0dG9ucyxcbiAgICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCB0aGVEaWFsb2cgPSBqUXVlcnkodGhpcykuY2xvc2VzdChcIi51aS1kaWFsb2dcIilcbiAgICAgICAgICAgICAgICB0aGVEaWFsb2cuZmluZChcIi51aS1idXR0b246Zmlyc3QtY2hpbGRcIikuYWRkQ2xhc3MoXG4gICAgICAgICAgICAgICAgICAgIFwiZnctYnV0dG9uIGZ3LWRhcmtcIilcbiAgICAgICAgICAgICAgICB0aGVEaWFsb2cuZmluZChcIi51aS1idXR0b246bGFzdFwiKS5hZGRDbGFzcyhcbiAgICAgICAgICAgICAgICAgICAgXCJmdy1idXR0b24gZnctb3JhbmdlXCIpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2xvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBqUXVlcnkoXCIjY29uZmlybWRlbGV0aW9uXCIpLmRpYWxvZygnZGVzdHJveScpLnJlbW92ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgYWRkSW1hZ2VEQihpbWFnZVBrcykge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlUGtzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLmFwcGVuZFRvSW1hZ2VUYWJsZShpbWFnZVBrc1tpXSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0YXJ0VXNlcm1lZGlhVGFibGUoKVxuICAgIH1cblxuICAgIGFwcGVuZFRvSW1hZ2VUYWJsZShwaykge1xuICAgICAgICBsZXQgaW1hZ2VJbmZvID0gdGhpcy5pbWFnZURCLmRiW3BrXVxuICAgICAgICBsZXQgJHRyID0galF1ZXJ5KCcjSW1hZ2VfJyArIHBrKVxuICAgICAgICBsZXQgZmlsZVR5cGUgPSBpbWFnZUluZm8uZmlsZV90eXBlLnNwbGl0KCcvJylcblxuICAgICAgICBpZigxIDwgZmlsZVR5cGUubGVuZ3RoKSB7XG4gICAgICAgICAgICBmaWxlVHlwZSA9IGZpbGVUeXBlWzFdLnRvVXBwZXJDYXNlKClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpbGVUeXBlID0gZmlsZVR5cGVbMF0udG9VcHBlckNhc2UoKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKDAgPCAkdHIubGVuZ3RoKSB7IC8vaWYgdGhlIGltYWdlIGVudHJ5IGV4aXN0cywgdXBkYXRlXG4gICAgICAgICAgICAkdHIucmVwbGFjZVdpdGgodXNlcm1lZGlhVGFibGVUZW1wbGF0ZSh7XG4gICAgICAgICAgICAgICAgcGssXG4gICAgICAgICAgICAgICAgJ2NhdHMnOiBpbWFnZUluZm8uY2F0cyxcbiAgICAgICAgICAgICAgICBmaWxlVHlwZSxcbiAgICAgICAgICAgICAgICAndGl0bGUnOiBpbWFnZUluZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgJ3RodW1ibmFpbCc6IGltYWdlSW5mby50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgJ2ltYWdlJzogaW1hZ2VJbmZvLmltYWdlLFxuICAgICAgICAgICAgICAgICdoZWlnaHQnOiBpbWFnZUluZm8uaGVpZ2h0LFxuICAgICAgICAgICAgICAgICd3aWR0aCc6IGltYWdlSW5mby53aWR0aCxcbiAgICAgICAgICAgICAgICAnYWRkZWQnOiBpbWFnZUluZm8uYWRkZWQsXG4gICAgICAgICAgICAgICAgbG9jYWxpemVEYXRlXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgfSBlbHNlIHsgLy9pZiB0aGlzIGlzIHRoZSBuZXcgaW1hZ2UsIGFwcGVuZFxuICAgICAgICAgICAgalF1ZXJ5KCcjaW1hZ2VsaXN0ID4gdGJvZHknKS5hcHBlbmQodXNlcm1lZGlhVGFibGVUZW1wbGF0ZSh7XG4gICAgICAgICAgICAgICAgcGssXG4gICAgICAgICAgICAgICAgJ2NhdHMnOiBpbWFnZUluZm8uY2F0cyxcbiAgICAgICAgICAgICAgICBmaWxlVHlwZSxcbiAgICAgICAgICAgICAgICAndGl0bGUnOiBpbWFnZUluZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgJ3RodW1ibmFpbCc6IGltYWdlSW5mby50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgJ2ltYWdlJzogaW1hZ2VJbmZvLmltYWdlLFxuICAgICAgICAgICAgICAgICdoZWlnaHQnOiBpbWFnZUluZm8uaGVpZ2h0LFxuICAgICAgICAgICAgICAgICd3aWR0aCc6IGltYWdlSW5mby53aWR0aCxcbiAgICAgICAgICAgICAgICAnYWRkZWQnOiBpbWFnZUluZm8uYWRkZWQsXG4gICAgICAgICAgICAgICAgbG9jYWxpemVEYXRlXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEltYWdlREIoKSB7XG4gICAgICAgIGxldCBpbWFnZUdldHRlciA9IG5ldyBJbWFnZURCKDApXG4gICAgICAgIGltYWdlR2V0dGVyLmdldERCKCkudGhlbihwa3MgPT4ge1xuICAgICAgICAgICAgdGhpcy5pbWFnZURCID0gaW1hZ2VHZXR0ZXJcbiAgICAgICAgICAgIHRoaXMubW9kLmNhdGVnb3JpZXMuYWRkSW1hZ2VDYXRlZ29yeUxpc3QoaW1hZ2VHZXR0ZXIuY2F0cylcbiAgICAgICAgICAgIHRoaXMuYWRkSW1hZ2VEQihwa3MpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgc3RvcFVzZXJtZWRpYVRhYmxlKCkge1xuICAgICAgICBqUXVlcnkoJyNpbWFnZWxpc3QnKS5kYXRhVGFibGUoKS5mbkRlc3Ryb3koKVxuICAgIH1cblxuICAgIHN0YXJ0VXNlcm1lZGlhVGFibGUoKSB7XG4gICAgICAgIC8qIFRoZSBzb3J0YWJsZSB0YWJsZSBzZWVtcyBub3QgdG8gaGF2ZSBhbiBvcHRpb24gdG8gYWNjZXB0IG5ldyBkYXRhXG4gICAgICAgIGFkZGVkIHRvIHRoZSBET00uIEluc3RlYWQgd2UgZGVzdHJveSBhbmQgcmVjcmVhdGUgaXQuXG4gICAgICAgICovXG5cbiAgICAgICAgalF1ZXJ5KCcjaW1hZ2VsaXN0JykuZGF0YVRhYmxlKHtcbiAgICAgICAgICAgIFwiYlBhZ2luYXRlXCI6IGZhbHNlLFxuICAgICAgICAgICAgXCJiTGVuZ3RoQ2hhbmdlXCI6IGZhbHNlLFxuICAgICAgICAgICAgXCJiRmlsdGVyXCI6IHRydWUsXG4gICAgICAgICAgICBcImJJbmZvXCI6IGZhbHNlLFxuICAgICAgICAgICAgXCJiQXV0b1dpZHRoXCI6IGZhbHNlLFxuICAgICAgICAgICAgXCJvTGFuZ3VhZ2VcIjoge1xuICAgICAgICAgICAgICAgIFwic1NlYXJjaFwiOiAnJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiYW9Db2x1bW5EZWZzXCI6IFt7XG4gICAgICAgICAgICAgICAgXCJiU29ydGFibGVcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgXCJhVGFyZ2V0c1wiOiBbMCwgMiwgNF1cbiAgICAgICAgICAgIH1dLFxuICAgICAgICB9KVxuICAgICAgICBqUXVlcnkoJyNpbWFnZWxpc3RfZmlsdGVyIGlucHV0JykuYXR0cigncGxhY2Vob2xkZXInLCBnZXR0ZXh0KCdTZWFyY2ggZm9yIEZpbGVuYW1lJykpXG5cbiAgICAgICAgalF1ZXJ5KCcjaW1hZ2VsaXN0X2ZpbHRlciBpbnB1dCcpLnVuYmluZCgnZm9jdXMsIGJsdXInKVxuICAgICAgICBqUXVlcnkoJyNpbWFnZWxpc3RfZmlsdGVyIGlucHV0JykuYmluZCgnZm9jdXMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGpRdWVyeSh0aGlzKS5wYXJlbnQoKS5hZGRDbGFzcygnZm9jdXMnKVxuICAgICAgICB9KVxuICAgICAgICBqUXVlcnkoJyNpbWFnZWxpc3RfZmlsdGVyIGlucHV0JykuYmluZCgnYmx1cicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgalF1ZXJ5KHRoaXMpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdmb2N1cycpXG4gICAgICAgIH0pXG5cbiAgICAgICAgbGV0IGF1dG9jb21wbGV0ZVRhZ3MgPSBbXVxuICAgICAgICBqUXVlcnkoJyNpbWFnZWxpc3QgLmZ3LXNlYXJjaGFibGUnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYXV0b2NvbXBsZXRlVGFncy5wdXNoKHRoaXMudGV4dENvbnRlbnQucmVwbGFjZSgvXlxccysvZywgJycpLnJlcGxhY2UoL1xccyskL2csICcnKSlcbiAgICAgICAgfSlcbiAgICAgICAgYXV0b2NvbXBsZXRlVGFncyA9IF8udW5pcShhdXRvY29tcGxldGVUYWdzKVxuICAgICAgICBqUXVlcnkoXCIjaW1hZ2VsaXN0X2ZpbHRlciBpbnB1dFwiKS5hdXRvY29tcGxldGUoe1xuICAgICAgICAgICAgc291cmNlOiBhdXRvY29tcGxldGVUYWdzXG4gICAgICAgIH0pXG4gICAgfVxuXG5cblxuICAgIGJpbmRFdmVudHMoKSB7XG4gICAgICAgIGxldCB0aGF0ID0gdGhpc1xuICAgICAgICBqUXVlcnkoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZGVsZXRlLWltYWdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGV0IEltYWdlSWQgPSBqUXVlcnkodGhpcykuYXR0cignZGF0YS1pZCcpXG4gICAgICAgICAgICB0aGF0LmRlbGV0ZUltYWdlRGlhbG9nKFtJbWFnZUlkXSlcbiAgICAgICAgfSlcblxuICAgICAgICBqUXVlcnkoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZWRpdC1pbWFnZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCBpSUQgPSBwYXJzZUludChqUXVlcnkodGhpcykuYXR0cignZGF0YS1pZCcpKVxuICAgICAgICAgICAgbGV0IGlUeXBlID0galF1ZXJ5KHRoaXMpLmF0dHIoJ2RhdGEtdHlwZScpXG4gICAgICAgICAgICBsZXQgaW1hZ2VVcGxvYWQgPSBuZXcgSW1hZ2VVcGxvYWREaWFsb2coXG4gICAgICAgICAgICAgICAgdGhhdC5pbWFnZURCLFxuICAgICAgICAgICAgICAgIGlJRCxcbiAgICAgICAgICAgICAgICAwXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBpbWFnZVVwbG9hZC5pbml0KCkudGhlbihcbiAgICAgICAgICAgICAgICBpbWFnZUlkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5zdG9wVXNlcm1lZGlhVGFibGUoKVxuICAgICAgICAgICAgICAgICAgICB0aGF0LmFwcGVuZFRvSW1hZ2VUYWJsZShpbWFnZUlkKVxuICAgICAgICAgICAgICAgICAgICB0aGF0LnN0YXJ0VXNlcm1lZGlhVGFibGUoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcblxuICAgICAgICB9KVxuICAgICAgICBqUXVlcnkoJyNlZGl0LWNhdGVnb3J5JykuYmluZCgnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm1vZC5jYXRlZ29yaWVzLmNyZWF0ZUNhdGVnb3J5RGlhbG9nKClcbiAgICAgICAgfSlcbiAgICAgICAgLy9vcGVuIGRyb3Bkb3duIGZvciBpbWFnZSBjYXRlZ29yeVxuICAgICAgICBhZGREcm9wZG93bkJveChqUXVlcnkoJyNpbWFnZS1jYXRlZ29yeS1idG4nKSwgalF1ZXJ5KFxuICAgICAgICAgICAgJyNpbWFnZS1jYXRlZ29yeS1wdWxsZG93bicpKVxuICAgICAgICBqUXVlcnkoZG9jdW1lbnQpLm9uKCdtb3VzZWRvd24nLCAnI2ltYWdlLWNhdGVnb3J5LXB1bGxkb3duIGxpID4gc3BhbicsXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5KCcjaW1hZ2UtY2F0ZWdvcnktYnRuID4gbGFiZWwnKS5odG1sKGpRdWVyeSh0aGlzKS5odG1sKCkpXG4gICAgICAgICAgICAgICAgalF1ZXJ5KCcjaW1hZ2UtY2F0ZWdvcnknKS52YWwoalF1ZXJ5KHRoaXMpLmF0dHIoJ2RhdGEtaWQnKSlcbiAgICAgICAgICAgICAgICBqUXVlcnkoJyNpbWFnZS1jYXRlZ29yeScpLnRyaWdnZXIoJ2NoYW5nZScpXG4gICAgICAgICAgICB9KVxuICAgICAgICAvL2ZpbHRlcmluZyBmdW5jdGlvbiBmb3IgdGhlIGxpc3Qgb2YgaW1hZ2VzXG4gICAgICAgIGpRdWVyeSgnI2ltYWdlLWNhdGVnb3J5JykuYmluZCgnY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGV0IGNhdFZhbCA9IGpRdWVyeSh0aGlzKS52YWwoKVxuICAgICAgICAgICAgaWYgKCcwJyA9PT0gY2F0VmFsKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5KCcjaW1hZ2VsaXN0ID4gdGJvZHkgPiB0cicpLnNob3coKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBqUXVlcnkoJyNpbWFnZWxpc3QgPiB0Ym9keSA+IHRyJykuaGlkZSgpXG4gICAgICAgICAgICAgICAgalF1ZXJ5KCcjaW1hZ2VsaXN0ID4gdGJvZHkgPiB0ci5jYXRfJyArIGNhdFZhbCkuc2hvdygpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC8vc2VsZWN0IGFsbCBlbnRyaWVzXG4gICAgICAgIGpRdWVyeSgnI3NlbGVjdC1hbGwtZW50cnknKS5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsZXQgbmV3Qm9vbCA9IGZhbHNlXG4gICAgICAgICAgICBpZiAoalF1ZXJ5KHRoaXMpLnByb3AoXCJjaGVja2VkXCIpKVxuICAgICAgICAgICAgICAgIG5ld0Jvb2wgPSB0cnVlXG4gICAgICAgICAgICBqUXVlcnkoJy5lbnRyeS1zZWxlY3QnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWQgPSBuZXdCb29sXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICAvL29wZW4gZHJvcGRvd24gZm9yIHNlbGVjdGluZyBhY3Rpb25cbiAgICAgICAgYWRkRHJvcGRvd25Cb3goalF1ZXJ5KCcjc2VsZWN0LWFjdGlvbi1kcm9wZG93bicpLCBqUXVlcnkoXG4gICAgICAgICAgICAnI2FjdGlvbi1zZWxlY3Rpb24tcHVsbGRvd24nKSlcbiAgICAgICAgLy9zdWJtaXQgaW1hZ2UgYWN0aW9uc1xuICAgICAgICBqUXVlcnkoJyNhY3Rpb24tc2VsZWN0aW9uLXB1bGxkb3duIGxpID4gc3BhbicpLmJpbmQoJ21vdXNlZG93bicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCBhY3Rpb25OYW1lID0galF1ZXJ5KHRoaXMpLmF0dHIoJ2RhdGEtYWN0aW9uJyksXG4gICAgICAgICAgICAgICAgaWRzID0gW11cbiAgICAgICAgICAgIGlmICgnJyA9PT0gYWN0aW9uTmFtZSB8fCAndW5kZWZpbmVkJyA9PSB0eXBlb2YgKGFjdGlvbk5hbWUpKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgalF1ZXJ5KCcuZW50cnktc2VsZWN0OmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZHNbaWRzLmxlbmd0aF0gPSBqUXVlcnkodGhpcykuYXR0cignZGF0YS1pZCcpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKDAgPT09IGlkcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbk5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgdGhhdC5kZWxldGVJbWFnZURpYWxvZyhpZHMpXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBpbml0KCkge1xuICAgICAgICB0aGlzLmJpbmRFdmVudHMoKVxuICAgICAgICB0aGlzLmdldEltYWdlREIoKVxuICAgIH1cblxuICAgIGJpbmQoKSB7XG4gICAgICAgIGpRdWVyeShkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pbml0KClcbiAgICAgICAgfSlcbiAgICB9XG5cbn1cbiJdfQ==","deps":{"../../common":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/common/index.js","./templates":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/templates.js","../database":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/database.js","../../menu":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/menu/index.js","./categories":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/categories.js","../upload-dialog":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/upload-dialog/index.js"}},"/home/kassawat/fiduswriter-develop/es6-cache/images-overview.es6.js":{"file":"/home/kassawat/fiduswriter-develop/es6-cache/images-overview.es6.js","source":"\"use strict\";\n\nvar _overview = require(\"./es6_modules/images/overview\");\n\nvar theImageOverview = new _overview.ImageOverview();\n\nwindow.theImageOverview = theImageOverview;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImltYWdlcy1vdmVydmlldy5lczYuanMiXSwibmFtZXMiOlsiSW1hZ2VPdmVydmlldyIsInRoZUltYWdlT3ZlcnZpZXciLCJ3aW5kb3ciXSwibWFwcGluZ3MiOiI7O0FBQUEsQUFBUSxBQUFSLEFBQTRCLEFBQTVCOztBQUVBLElBQUksbUJBQW1CLEFBQUksQUFBSixBQUF2Qjs7QUFFQSxPQUFPLEFBQVAsbUJBQTBCLEFBQTFCIiwiZmlsZSI6ImltYWdlcy1vdmVydmlldy5lczYuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0ltYWdlT3ZlcnZpZXd9IGZyb20gXCIuL2VzNl9tb2R1bGVzL2ltYWdlcy9vdmVydmlld1wiXG5cbmxldCB0aGVJbWFnZU92ZXJ2aWV3ID0gbmV3IEltYWdlT3ZlcnZpZXcoKVxuXG53aW5kb3cudGhlSW1hZ2VPdmVydmlldyA9IHRoZUltYWdlT3ZlcnZpZXdcbiJdfQ==","deps":{"./es6_modules/images/overview":"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/index.js"}}},"mtimes":{"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/common/index.js":1485131707908,"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/templates.js":1485131707908,"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/database.js":1485131707904,"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/menu/index.js":1485131707904,"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/categories.js":1485131707908,"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/upload-dialog/templates.js":1485131707908,"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/upload-dialog/index.js":1485131707908,"/home/kassawat/fiduswriter-develop/es6-cache/es6_modules/images/overview/index.js":1485131707908,"/home/kassawat/fiduswriter-develop/es6-cache/images-overview.es6.js":1485131707904},"dependentFiles":{}}